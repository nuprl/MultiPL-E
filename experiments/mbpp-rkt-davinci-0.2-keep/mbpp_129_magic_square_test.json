{
  "name": "mbpp_129_magic_square_test",
  "language": "rkt",
  "prompt": "#lang racket\n\n;; Write a function to calculate whether the matrix is a magic square.\n(define (magic_square_test my_matrix)\n",
  "doctests": "keep",
  "original": "/home/arjun/repos/MultiPL-E/datasets/../datasets/mbpp-typed/mbpp_129_magic_square_test.py",
  "prompt_terminology": "verbatim",
  "tests": "(require rackunit)\n\n(define (test-humaneval) \n\n  (let (( candidate magic_square_test))\n    (check-equal? (candidate (list (list 7 12 1 14) (list 2 13 8 11) (list 16 3 10 5) (list 9 6 15 4))) #t)\n    (check-equal? (candidate (list (list 2 7 6) (list 9 5 1) (list 4 3 8))) #t)\n    (check-equal? (candidate (list (list 2 7 6) (list 9 5 1) (list 4 3 7))) #f)\n))\n\n(test-humaneval)",
  "stop_tokens": [
    "\n(define ",
    "\n#|",
    "\n;",
    "\n("
  ],
  "completions": [
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (sum (apply + (car my_matrix)))\n         (sum_row (lambda (row) (apply + row)))\n         (sum_col (lambda (col) (apply + (map (lambda (row) (list-ref row col)) my_matrix))))\n         (sum_diag (lambda (diag) (apply + (map (lambda (row) (list-ref row (diag row))) my_matrix)))))\n    (and (= n m)\n         (andmap (lambda (row) (= (sum_row row) sum)) my_matrix)\n         (andmap (lambda (col) (= (sum_col col) sum)) (range 0 n))\n         (= (sum_diag (lambda (row) row)) sum)\n         (= (sum_diag (lambda (row) (- n 1 row))) sum))))\n",
    "  (let ((n (length my_matrix)))\n    (define (sum_row row)\n      (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n    (define (sum_col col)\n      (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n    (define (sum_diag)\n      (apply + (map (lambda (x) (vector-ref x x)) my_matrix)))\n    (define (sum_diag_rev)\n      (apply + (map (lambda (x) (vector-ref x (- n 1 x))) my_matrix)))\n    (define (sum_row_col row col)\n      (apply + (map (lambda (x) (vector-ref x col)) (map (lambda (x) (vector-ref x row)) my_matrix))))\n    (define (sum_row_col_rev row col)\n      (apply + (map (lambda (x) (vector-ref x (- n 1 col))) (map (lambda (x) (vector-ref x row)) my_matrix))))\n    (define (sum_col_row col row)\n      (apply + (map (lambda (x) (vector-ref x row)) (map (lambda (x) (vector-ref x col)) my_matrix))))\n    (define (sum_col_row_rev col row)\n      (apply + (map (lambda (x) (vector-ref x (- n 1 row))) (map (lambda (x) (vector-ref x col)) my_matrix))))\n    (define (sum_diag_row row)\n      (apply + (map (lambda (x) (vector-ref x x)) (map (lambda (x) (vector-ref x row)) my_matrix))))\n    (define (sum_diag_row_rev row)\n      (apply + (map (lambda (x) (vector-ref x (- n 1 x))) (map (lambda (x) (vector-ref x row)) my_matrix))))\n    (define (sum_diag_col col)\n      (apply + (map (lambda (x) (vector-ref x x)) (map (lambda (",
    "  (let ((n (length my_matrix)))\n    (let ((sum (apply + (list-ref my_matrix 0))))\n      (let ((row_sums (map (lambda (row) (apply + row)) my_matrix)))\n        (let ((col_sums (map (lambda (col) (apply + (map (lambda (row) (list-ref row col)) my_matrix))) (range n))))\n          (let ((diag_sums (list (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n)))\n                                (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n))))))\n            (and (apply = row_sums) (apply = col_sums) (apply = diag_sums)))))))))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (define (magic_square_test_helper_helper my_matrix)\n      (define (magic_square_test_helper_helper_helper my_matrix)\n        (define (magic_square_test_helper_helper_helper_helper my_matrix)\n          (define (magic_square_test_helper_helper_helper_helper_helper my_matrix)\n            (define (magic_square_test_helper_helper_helper_helper_helper_helper my_matrix)\n              (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                  (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                    (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                      (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                        (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                          (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                            (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_hel",
    "  (let ((n (length my_matrix)))\n    (let ((m (length (car my_matrix))))\n      (let ((sum (apply + (car my_matrix))))\n        (and (= n m)\n             (every (lambda (row) (= sum (apply + row))) my_matrix)\n             (every (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (every (lambda (row) (= sum (apply + row))) my_matrix)\n         (every (lambda (col) (= sum (apply + col)))\n                (transpose my_matrix))\n         (= sum (apply + (diagonal my_matrix)))\n         (= sum (apply + (diagonal (reverse my_matrix)))))))\n",
    "  (define (magic_square_test_helper my_matrix my_sum)\n    (cond\n      [(empty? my_matrix) #t]\n      [(not (= (sum_row (first my_matrix)) my_sum)) #f]\n      [(not (= (sum_col (first my_matrix)) my_sum)) #f]\n      [(not (= (sum_diag my_matrix) my_sum)) #f]\n      [(not (= (sum_diag (reverse my_matrix)) my_sum)) #f]\n      [else (magic_square_test_helper (rest my_matrix) my_sum)]))\n  (magic_square_test_helper my_matrix (sum_row (first my_matrix))))\n",
    "  (define (sum_of_row row)\n    (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n  (define (sum_of_col col)\n    (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n  (define (sum_of_diag direction)\n    (apply + (map (lambda (x) (vector-ref x x)) my_matrix)))\n  (define (sum_of_anti_diag direction)\n    (apply + (map (lambda (x) (vector-ref x (- (vector-length my_matrix) x 1))) my_matrix)))\n  (define (sum_of_row_or_col row_or_col)\n    (cond\n      [(eq? row_or_col 'row) (sum_of_row 0)]\n      [(eq? row_or_col 'col) (sum_of_col 0)]))\n  (define (sum_of_diag_or_anti_diag direction)\n    (cond\n      [(eq? direction 'diag) (sum_of_diag 0)]\n      [(eq? direction 'anti_diag) (sum_of_anti_diag 0)]))\n  (define (all_equal? my_list)\n    (cond\n      [(null? my_list) #t]\n      [(null? (cdr my_list)) #t]\n      [(eq? (car my_list) (car (cdr my_list))) (all_equal? (cdr my_list))]\n      [else #f]))\n  (define (all_equal_to_first? my_list)\n    (all_equal? (cons (car my_list) (cdr my_list))))\n  (define (all_equal_to_first_row? my_matrix)\n    (all_equal_to_first? (map sum_of_row (range (vector-length my_matrix)))))\n  (define (all_equal_to_first_col? my_matrix)\n    (all_equal_to_first? (map sum_of_col (range (vector-length my",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (x) (= sum (apply + x))) my_matrix)\n         (andmap (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))\n         (= sum (apply + (map (lambda (x) (list-ref (car my_matrix) x)) (range n))))\n         (= sum (apply + (map (lambda (x) (list-ref (car (reverse my_matrix)) x)) (range n)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [magic_number (+ (* n (/ n 2)) (/ n 6))])\n    (cond\n      [(not (= n m)) #f]\n      [(not (= n (length (car (cdr my_matrix))))) #f]\n      [(not (= (apply + my_matrix) magic_number)) #f]\n      [(not (= (apply + (map sum my_matrix)) magic_number)) #f]\n      [(not (= (apply + (map (lambda (x) (sum (map (lambda (y) (list-ref y x)) my_matrix))) (range n))) magic_number)) #f]\n      [(not (= (sum (map (lambda (x) (list-ref (car my_matrix) x)) (range n))) magic_number)) #f]\n      [(not (= (sum (map (lambda (x) (list-ref (car (reverse my_matrix)) x)) (range n))) magic_number)) #f]\n      [else #t])))\n",
    "  (let ([rows (length my_matrix)]\n        [cols (length (car my_matrix))])\n    (if (and (= rows cols)\n             (= rows (length (cdr my_matrix))))\n        (let ([row_sums (map (lambda (row) (apply + row)) my_matrix)]\n              [col_sums (map (lambda (col) (apply + col)) (transpose my_matrix))]\n              [diag_sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range rows)))])\n          (and (= (apply + row_sums) (apply + col_sums))\n               (= (apply + row_sums) diag_sum)))\n        #f)))\n",
    "  (let ((n (length my_matrix)))\n    (and\n     (= n (length (car my_matrix)))\n     (andmap\n      (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                     (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n      (iota n))\n     (andmap\n      (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                     (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n      (iota n))\n     (andmap\n      (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                     (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n      (iota n))\n     (andmap\n      (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                     (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n      (iota n))\n     (andmap\n      (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                     (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n      (iota n))\n     (andmap\n      (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                     (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n      (iota n))\n     (andmap\n      (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                     (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n      (iota n))\n     (andmap\n      (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))",
    "  (define (magic_square_test_helper my_matrix)\n    (define (sum_row my_matrix row)\n      (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n    (define (sum_col my_matrix col)\n      (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n    (define (sum_diag my_matrix)\n      (apply + (map (lambda (x) (vector-ref x x)) my_matrix)))\n    (define (sum_anti_diag my_matrix)\n      (apply + (map (lambda (x) (vector-ref x (- (vector-length x) 1))) my_matrix)))\n    (define (sum_all_rows my_matrix)\n      (map (lambda (x) (sum_row my_matrix x)) (range (vector-length (vector-ref my_matrix 0)))))\n    (define (sum_all_cols my_matrix)\n      (map (lambda (x) (sum_col my_matrix x)) (range (vector-length (vector-ref my_matrix 0)))))\n    (define (sum_all_diags my_matrix)\n      (list (sum_diag my_matrix) (sum_anti_diag my_matrix)))\n    (define (sum_all my_matrix)\n      (append (sum_all_rows my_matrix) (sum_all_cols my_matrix) (sum_all_diags my_matrix)))\n    (define (all_equal? my_list)\n      (apply = my_list))\n    (all_equal? (sum_all my_matrix)))\n  (if (and (= (vector-length my_matrix) (vector-length (vector-ref my_matrix 0)))\n           (= (vector-length my_matrix) (vector-length (vector-ref my_matrix 1))))\n      (magic_square_test_helper my_matrix)\n      #f))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (transpose my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals (reverse my_matrix))))\n            (* n (+ n 1) (/ n 2))))))\n",
    "  (let ([n (length my_matrix)])\n    (let ([sum (apply + (map (lambda (x) (apply + x)) my_matrix))])\n      (and\n       (= sum (/ (* n (+ n 1) (* n n)) 2))\n       (let ([sum_rows (map (lambda (x) (apply + x)) my_matrix)])\n         (and\n          (= (apply + sum_rows) sum)\n          (let ([sum_cols (map (lambda (x) (apply + (map (lambda (y) (list-ref y x)) my_matrix))) (range n))])\n            (and\n             (= (apply + sum_cols) sum)\n             (let ([sum_diag1 (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) x)) (range n)))])\n               (and\n                (= sum_diag1 sum)\n                (let ([sum_diag2 (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) (- n 1 x))) (range n)))])\n                  (= sum_diag2 sum))))))))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row)))\n                 my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col))\n                                                    my_matrix))))\n                 (range n))\n         (andmap (lambda (diag) (= sum (apply + diag)))\n                 (list (map (lambda (i) (list-ref (list-ref my_matrix i) i))\n                            (range n))\n                       (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i)))\n                            (range n)))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n            (* n (+ 1 (* n n)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let ((n (length my_matrix)))\n    (let ((magic_sum (apply + (list-ref my_matrix 0 0) (list-ref my_matrix 0 1) (list-ref my_matrix 0 2))))\n      (let ((row_sum 0) (col_sum 0) (diag_sum 0) (diag_sum2 0))\n        (for ((i 0) (j 0))\n             ((= i n) #t)\n             (set! row_sum (+ row_sum (list-ref my_matrix i j)))\n             (set! col_sum (+ col_sum (list-ref my_matrix j i)))\n             (set! diag_sum (+ diag_sum (list-ref my_matrix i i)))\n             (set! diag_sum2 (+ diag_sum2 (list-ref my_matrix i (- n 1 i))))\n             (if (= j (- n 1))\n                 (begin\n                   (if (not (= row_sum magic_sum))\n                       (return #f))\n                   (if (not (= col_sum magic_sum))\n                       (return #f))\n                   (set! row_sum 0)\n                   (set! col_sum 0)\n                   (set! j 0)\n                   (set! i (+ i 1))))\n             (set! j (+ j 1))))\n        (if (not (= diag_sum magic_sum))\n            (return #f))\n        (if (not (= diag_sum2 magic_sum))\n            (return #f))\n        #t))))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (define (magic_square_test_helper_helper my_matrix)\n      (define (magic_square_test_helper_helper_helper my_matrix)\n        (define (magic_square_test_helper_helper_helper_helper my_matrix)\n          (define (magic_square_test_helper_helper_helper_helper_helper my_matrix)\n            (define (magic_square_test_helper_helper_helper_helper_helper_helper my_matrix)\n              (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                  (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                    (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                      (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                        (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                          (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                            (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_hel",
    "  (let ((n (length my_matrix))\n        (sum (apply + (car my_matrix))))\n    (and (= n (length (car my_matrix)))\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range n))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (every (lambda (row) (= sum (apply + row))) my_matrix)\n         (every (lambda (col) (= sum (apply + col)))\n                (for/list ([i (in-range n)])\n                  (for/list ([j (in-range m)])\n                    (list-ref (list-ref my_matrix j) i)))))))\n",
    "  (define (sum_row row)\n    (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n  (define (sum_col col)\n    (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n  (define (sum_diag)\n    (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range (vector-length my_matrix)))))\n  (define (sum_diag2)\n    (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range (vector-length my_matrix) -1 0))))\n  (define (sum_all)\n    (apply + (apply append my_matrix)))\n  (define (check_row)\n    (apply = (map sum_row (range (vector-length my_matrix)))))\n  (define (check_col)\n    (apply = (map sum_col (range (vector-length my_matrix)))))\n  (define (check_diag)\n    (and (= (sum_diag) (sum_diag2)) (= (sum_diag) (sum_all))))\n  (and (check_row) (check_col) (check_diag)))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix))))\n                 (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (transpose my_matrix)))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals my_matrix)))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals (reverse my_matrix))))\n            (* n (/ (+ 1 (* n n)) 2))))))\n",
    "  (let* ([row_sum (apply + (map (lambda (x) (apply + x)) my_matrix))]\n         [col_sum (apply + (map (lambda (x) (apply + (map (lambda (y) (list-ref y x)) my_matrix))) (range (length (car my_matrix)))))]\n         [diag_sum (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) x)) (range (length (car my_matrix)))))]\n         [anti_diag_sum (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) (- (length (car my_matrix)) x 1))) (range (length (car my_matrix)))))]\n         [sums (list row_sum col_sum diag_sum anti_diag_sum)])\n    (and (= (length (remove-duplicates sums)) 1)\n         (= (apply max sums) (apply min sums)))))\n",
    "  (let ((n (length my_matrix)))\n    (and (= n (length (car my_matrix)))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i))\n                                          my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0))\n                                          my_matrix))))\n                 (iota n))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i))\n                                          my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0))\n                                          my_matrix))))\n                 (iota n))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i))\n                                          my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0))\n                                          my_matrix))))\n                 (iota n))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i))\n                                          my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0))\n                                          my_matrix))))\n                 (iota n))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i))\n                                          my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0))\n                                          my_matrix))))\n                 (iota n))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i))\n                                          my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0))\n                                          my_matrix))))\n                 (iota n))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i))\n                                          my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0))\n                                ",
    "  (let ((n (length my_matrix)))\n    (let ((sum (apply + (map (lambda (x) (apply + x)) my_matrix))))\n      (and\n       (= sum (* n (/ (+ n 1) 2)))\n       (andmap (lambda (x) (= sum (apply + x))) my_matrix)\n       (andmap (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (andmap (lambda (i) (= (apply + (map (lambda (row) (list-ref row i)) my_matrix))\n                                (apply + my_matrix)))\n                 (range n))\n         (andmap (lambda (i) (= (apply + (map (lambda (row) (list-ref row i)) my_matrix))\n                                (apply + (map list-ref my_matrix i))))\n                 (range n))\n         (andmap (lambda (i) (= (apply + (map (lambda (row) (list-ref row i)) my_matrix))\n                                (apply + (map list-ref (reverse my_matrix) i))))\n                 (range n)))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let ([n (length my_matrix)])\n    (let ([sum (apply + (list-ref my_matrix 0))])\n      (for ([i (in-range n)])\n        (if (not (= sum (apply + (list-ref my_matrix i))))\n          (return #f)))\n      (for ([i (in-range n)])\n        (let ([sum 0])\n          (for ([j (in-range n)])\n            (set! sum (+ sum (list-ref (list-ref my_matrix j) i))))\n          (if (not (= sum (apply + (list-ref my_matrix 0))))\n            (return #f))))\n      (let ([sum 0])\n        (for ([i (in-range n)])\n          (set! sum (+ sum (list-ref (list-ref my_matrix i) i))))\n        (if (not (= sum (apply + (list-ref my_matrix 0))))\n          (return #f)))\n      (let ([sum 0])\n        (for ([i (in-range n)])\n          (set! sum (+ sum (list-ref (list-ref my_matrix i) (- n 1 i)))))\n        (if (not (= sum (apply + (list-ref my_matrix 0))))\n          (return #f)))\n      #t)))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (transpose my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonal my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonal (reverse my_matrix))))\n            (* n (+ n 1) (/ n 2))))))\n",
    "  (let ((n (length my_matrix)))\n    (and (= n (length (car my_matrix)))\n         (andmap (lambda (i) (= (apply + (map (lambda (x) (list-ref x i)) my_matrix))\n                                (apply + (map (lambda (x) (list-ref x i)) (transpose my_matrix)))))\n                 (range n))\n         (andmap (lambda (i) (= (apply + (map (lambda (x) (list-ref x i)) my_matrix))\n                                (apply + (map (lambda (x) (list-ref x i)) (transpose my_matrix)))))\n                 (range n))\n         (= (apply + (map (lambda (x) (list-ref x i)) my_matrix))\n            (apply + (map (lambda (x) (list-ref x i)) (transpose my_matrix))))\n         (= (apply + (map (lambda (x) (list-ref x i)) my_matrix))\n            (apply + (map (lambda (x) (list-ref x i)) (transpose my_matrix)))))))\n</code>\n",
    "  (let* ((n (length my_matrix))\n         (sums (map (lambda (row) (apply + row)) my_matrix))\n         (sum (apply + sums))\n         (cols (for/list ([i (in-range n)])\n                 (for/list ([j (in-range n)])\n                   (list-ref (list-ref my_matrix j) i)))))\n    (and (= (length (remove-duplicates sums)) 1)\n         (= (length (remove-duplicates cols)) 1)\n         (= (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i))\n                          (in-range n)))\n            sum)\n         (= (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i)))\n                          (in-range n)))\n            sum))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let ((n (length my_matrix)))\n    (let ((sum (apply + (map (lambda (x) (apply + x)) my_matrix))))\n      (and\n       (andmap (lambda (x) (= sum (apply + x))) my_matrix)\n       (andmap (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))\n       (= sum (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) x)) (range n))))\n       (= sum (apply + (map (lambda (x) (list-ref (list-ref my_matrix (- n 1 x)) x)) (range n))))))))\n",
    "  (let ((n (length my_matrix)))\n    (let ((row_sum (apply + (map (lambda (row) (apply + row)) my_matrix))))\n      (let ((col_sum (apply + (map (lambda (col) (apply + col)) (transpose my_matrix)))))\n        (let ((diag_sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n)))))\n          (let ((anti_diag_sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n i 1))) (range n)))))\n            (and (= row_sum col_sum) (= row_sum diag_sum) (= row_sum anti_diag_sum))))))))\n",
    "  (let ((n (length my_matrix)))\n    (let ((sum (apply + (map (lambda (x) (apply + x)) my_matrix))))\n      (and\n       (andmap (lambda (x) (= sum (apply + x))) my_matrix)\n       (andmap (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))))))\n",
    "  (let* ((n (length my_matrix))\n         (sum (apply + (car my_matrix))))\n    (and (= (length (car my_matrix)) n)\n         (andmap (lambda (row) (= (apply + row) sum)) my_matrix)\n         (andmap (lambda (col) (= (apply + col) sum))\n                 (for/list ([i (in-range n)]\n                            [j (in-range n)])\n                   (list-ref (list-ref my_matrix j) i)))\n         (andmap (lambda (diag) (= (apply + diag) sum))\n                 (list (for/list ([i (in-range n)])\n                         (list-ref (list-ref my_matrix i) i))\n                       (for/list ([i (in-range n)])\n                         (list-ref (list-ref my_matrix i) (- n 1 i))))))))\n",
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (sum (apply + (car my_matrix)))\n         (sum_list (list sum)))\n    (if (and (= n m)\n             (= (apply + (car my_matrix))\n                (apply + (map (lambda (x) (car x)) my_matrix))))\n        (let loop ((i 1) (j 0))\n          (if (= i n)\n              (if (apply =? sum_list)\n                  #t\n                  #f)\n              (if (= j n)\n                  (loop (+ i 1) 0)\n                  (let ((new_sum (+ sum (- (list-ref (list-ref my_matrix i) j)\n                                          (list-ref (list-ref my_matrix (- i 1)) (- j 1))))))\n                    (loop i (+ j 1))\n                    (set! sum_list (append sum_list (list new_sum)))))))\n        #f)))\n",
    "  (let ((n (length my_matrix)))\n    (and\n     (equal? (length (car my_matrix)) n)\n     (andmap (lambda (x) (equal? (length x) n)) (cdr my_matrix))\n     (andmap (lambda (x) (equal? (apply + x) (/ (* n (+ n 1)) 2))) my_matrix)\n     (andmap (lambda (x) (equal? (apply + x) (/ (* n (+ n 1)) 2))) (transpose my_matrix))\n     (equal? (apply + (diagonal my_matrix)) (/ (* n (+ n 1)) 2))\n     (equal? (apply + (diagonal (reverse my_matrix))) (/ (* n (+ n 1)) 2)))))\n",
    "  (let* ((n (length my_matrix))\n         (s (apply + (map (lambda (x) (apply + x)) my_matrix))))\n    (and (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n              (* s (/ n 1.0)))\n         (= (apply + (map (lambda (x) (apply + (map (lambda (y) (list-ref y x)) my_matrix))) my_matrix))\n              (* s (/ n 1.0)))\n         (= (apply + (map (lambda (x) (list-ref x x)) my_matrix))\n              (* s (/ n 1.0)))\n         (= (apply + (map (lambda (x) (list-ref x (- n 1 x))) my_matrix))\n              (* s (/ n 1.0))))))\n",
    "  (define (row_sum row)\n    (apply + (list-ref my_matrix row)))\n  (define (column_sum col)\n    (apply + (map (lambda (row) (list-ref row col)) my_matrix)))\n  (define (diagonal_sum)\n    (apply + (map (lambda (row) (list-ref row row)) my_matrix)))\n  (define (reverse_diagonal_sum)\n    (apply + (map (lambda (row) (list-ref row (- (length my_matrix) row 1))) my_matrix)))\n  (define (all_equal? lst)\n    (cond ((null? (cdr lst)) #t)\n          ((equal? (car lst) (cadr lst)) (all_equal? (cdr lst)))\n          (else #f)))\n  (define (row_sums)\n    (map row_sum (range (length my_matrix))))\n  (define (column_sums)\n    (map column_sum (range (length my_matrix))))\n  (all_equal? (append (row_sums) (column_sums) (list diagonal_sum reverse_diagonal_sum))))\n",
    "  (let ((n (length my_matrix)))\n    (if (= n 0)\n        #f\n        (let ((sum (apply + (car my_matrix))))\n          (if (foldl (lambda (row result)\n                       (if (not (= sum (apply + row)))\n                           #f\n                           result))\n                     #t\n                     (cdr my_matrix))\n              (let ((col_sum (foldl (lambda (row result)\n                                      (map + row result))\n                                    (make-list n 0)\n                                    my_matrix)))\n                (if (foldl (lambda (col result)\n                             (if (not (= sum col))\n                                 #f\n                                 result))\n                           #t\n                           col_sum)\n                    (let ((diag_sum (foldl (lambda (row result)\n                                             (if (not (= sum (car row)))\n                                                 #f\n                                                 (+ (car row) result)))\n                                           0\n                                           my_matrix)))\n                      (if (foldl (lambda (row result)\n                                   (if (not (= sum (car (reverse row))))\n                                       #f\n                                       (+ (car (reverse row)) result)))\n                                 0\n                                 my_matrix)\n                          (= diag_sum sum)\n                          #f))\n                    #f))\n              #f)))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map sum my_matrix)) (* n (/ (+ 1 n) 2)))\n         (= (apply + (map sum (transpose my_matrix))) (* n (/ (+ 1 n) 2)))\n         (= (apply + (map sum (diagonals my_matrix))) (* n (/ (+ 1 n) 2)))\n         (= (apply + (map sum (diagonals (reverse my_matrix)))) (* n (/ (+ 1 n) 2))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [magic_sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= magic_sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= magic_sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= magic_sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= magic_sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n i 1))) (range n)))))))\n",
    "  (let ([row_sum (apply + (map sum my_matrix))])\n    (and\n     (every? (lambda (row) (= row row_sum)) (map sum my_matrix))\n     (every? (lambda (col) (= col row_sum)) (map sum (transpose my_matrix)))\n     (= row_sum (sum (diagonal my_matrix)))\n     (= row_sum (sum (diagonal (reverse my_matrix)))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x))\n                          (map (lambda (x) (map list x)) my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x))\n                          (map (lambda (x) (map list (reverse x))) my_matrix)))\n            (* n (+ n 1) (/ n 2))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix))))\n                 (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (define (sum_of_row my_matrix row)\n    (apply + (list-ref my_matrix row)))\n  (define (sum_of_col my_matrix col)\n    (apply + (map (lambda (row) (list-ref row col)) my_matrix)))\n  (define (sum_of_diag my_matrix)\n    (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range (length my_matrix)))))\n  (define (sum_of_anti_diag my_matrix)\n    (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- (length my_matrix) 1 i))) (range (length my_matrix)))))\n  (define (sum_of_all_rows my_matrix)\n    (map (lambda (row) (sum_of_row my_matrix row)) (range (length my_matrix))))\n  (define (sum_of_all_cols my_matrix)\n    (map (lambda (col) (sum_of_col my_matrix col)) (range (length my_matrix))))\n  (define (sum_of_all_diags my_matrix)\n    (list (sum_of_diag my_matrix) (sum_of_anti_diag my_matrix)))\n  (define (sum_of_all_elements my_matrix)\n    (append (sum_of_all_rows my_matrix) (sum_of_all_cols my_matrix) (sum_of_all_diags my_matrix)))\n  (define (all_equal? my_list)\n    (cond ((null? (cdr my_list)) #t)\n          ((equal? (car my_list) (cadr my_list)) (all_equal? (cdr my_list)))\n          (else #f)))\n  (all_equal? (sum_of_all_elements my_matrix)))\n",
    "  (define (sum_of_row my_matrix row_index)\n    (apply + (map (lambda (x) (list-ref x row_index)) my_matrix)))\n  (define (sum_of_col my_matrix col_index)\n    (apply + (map (lambda (x) (list-ref x col_index)) my_matrix)))\n  (define (sum_of_diag my_matrix)\n    (apply + (map (lambda (x) (list-ref x x)) my_matrix)))\n  (define (sum_of_anti_diag my_matrix)\n    (apply + (map (lambda (x) (list-ref x (- (length my_matrix) x 1))) my_matrix)))\n  (define (sum_of_all_rows my_matrix)\n    (map (lambda (x) (sum_of_row my_matrix x)) (range (length my_matrix))))\n  (define (sum_of_all_cols my_matrix)\n    (map (lambda (x) (sum_of_col my_matrix x)) (range (length my_matrix))))\n  (define (sum_of_all_diags my_matrix)\n    (list (sum_of_diag my_matrix) (sum_of_anti_diag my_matrix)))\n  (define (sum_of_all my_matrix)\n    (append (sum_of_all_rows my_matrix) (sum_of_all_cols my_matrix) (sum_of_all_diags my_matrix)))\n  (define (all_equal? my_list)\n    (cond ((null? (cdr my_list)) #t)\n          ((equal? (car my_list) (cadr my_list)) (all_equal? (cdr my_list)))\n          (else #f)))\n  (all_equal? (sum_of_all my_matrix)))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (andmap (lambda (i) (= (apply + (map (lambda (j) (list-ref (list-ref my_matrix i) j)) (range n))) (apply + (map (lambda (j) (list-ref (list-ref my_matrix j) i)) (range n))))) (range n))\n         (= (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))) (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (transpose my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals (reverse my_matrix))))\n            (* n (+ n 1) (/ n 2))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [s (apply + (map (lambda (x) (apply + x)) my_matrix))]\n         [s1 (apply + (map (lambda (x) (list-ref x 0)) my_matrix))]\n         [s2 (apply + (map (lambda (x) (list-ref x 1)) my_matrix))]\n         [s3 (apply + (map (lambda (x) (list-ref x 2)) my_matrix))]\n         [s4 (apply + (map (lambda (x) (list-ref x 0) (cdr x)) my_matrix))]\n         [s5 (apply + (map (lambda (x) (list-ref x 1) (cdr x)) my_matrix))]\n         [s6 (apply + (map (lambda (x) (list-ref x 2) (cdr x)) my_matrix))]\n         [s7 (apply + (map (lambda (x) (list-ref x 0) (cddr x)) my_matrix))]\n         [s8 (apply + (map (lambda (x) (list-ref x 1) (cddr x)) my_matrix))]\n         [s9 (apply + (map (lambda (x) (list-ref x 2) (cddr x)) my_matrix))])\n    (and (= s s1) (= s s2) (= s s3) (= s s4) (= s s5) (= s s6) (= s s7) (= s s8) (= s s9))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (apply = (map sum my_matrix))\n         (apply = (map sum (transpose my_matrix)))\n         (apply = (map sum (diagonals my_matrix))))))\n",
    "  (define (sum_row my_matrix row)\n    (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n  (define (sum_col my_matrix col)\n    (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n  (define (sum_diag my_matrix)\n    (apply + (map (lambda (x) (vector-ref x x)) my_matrix)))\n  (define (sum_diag_rev my_matrix)\n    (apply + (map (lambda (x) (vector-ref x (- (vector-length my_matrix) x 1))) my_matrix)))\n  (define (sum_all_rows my_matrix)\n    (map (lambda (x) (sum_row my_matrix x)) (range (vector-length my_matrix))))\n  (define (sum_all_cols my_matrix)\n    (map (lambda (x) (sum_col my_matrix x)) (range (vector-length my_matrix))))\n  (define (sum_all_diags my_matrix)\n    (list (sum_diag my_matrix) (sum_diag_rev my_matrix)))\n  (define (sum_all my_matrix)\n    (append (sum_all_rows my_matrix) (sum_all_cols my_matrix) (sum_all_diags my_matrix)))\n  (define (check_all_same my_list)\n    (andmap (lambda (x) (= x (car my_list))) (cdr my_list)))\n  (check_all_same (sum_all my_matrix)))\n",
    "  (let ((n (length my_matrix)))\n    (let ((magic_sum (apply + (map (lambda (x) (list-ref (list-ref my_matrix 0) x)) (range n)))))\n      (and\n       (andmap (lambda (x) (= magic_sum (apply + (map (lambda (y) (list-ref (list-ref my_matrix x) y)) (range n))))) (range n))\n       (andmap (lambda (x) (= magic_sum (apply + (map (lambda (y) (list-ref (list-ref my_matrix y) x)) (range n))))) (range n))\n       (= magic_sum (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) x)) (range n))))\n       (= magic_sum (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) (- n 1 x))) (range n))))))))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (define (sum_row row_index)\n      (apply + (list-ref my_matrix row_index)))\n    (define (sum_column column_index)\n      (apply + (map (lambda (row) (list-ref row column_index)) my_matrix)))\n    (define (sum_diagonal)\n      (apply + (map (lambda (index) (list-ref (list-ref my_matrix index) index)) (range (length my_matrix)))))\n    (define (sum_anti_diagonal)\n      (apply + (map (lambda (index) (list-ref (list-ref my_matrix index) (- (length my_matrix) index 1))) (range (length my_matrix)))))\n    (define (sum_all_rows)\n      (map sum_row (range (length my_matrix))))\n    (define (sum_all_columns)\n      (map sum_column (range (length my_matrix))))\n    (define (sum_all_diagonals)\n      (list sum_diagonal sum_anti_diagonal))\n    (define (sum_all_lists)\n      (append sum_all_rows sum_all_columns sum_all_diagonals))\n    (define (all_equal? my_list)\n      (cond ((null? (cdr my_list)) #t)\n            ((= (car my_list) (car (cdr my_list))) (all_equal? (cdr my_list)))\n            (else #f)))\n    (all_equal? sum_all_lists))\n  (cond ((not (list? my_matrix)) #f)\n        ((not (all_equal? (map length my_matrix))) #f)\n        ((not (all_equal? (map (lambda (row) (map number? row)) my_matrix))) #f)\n        (else (magic_square_test_helper my_matrix))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range n))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (sums (make-vector n 0))\n         (sums2 (make-vector m 0)))\n    (for ([i (in-range n)])\n      (for ([j (in-range m)])\n        (vector-set! sums i (+ (vector-ref sums i) (vector-ref (vector-ref my_matrix i) j)))\n        (vector-set! sums2 j (+ (vector-ref sums2 j) (vector-ref (vector-ref my_matrix i) j)))))\n    (if (and (= (vector-ref sums 0) (vector-ref sums 1))\n             (= (vector-ref sums 0) (vector-ref sums 2)))\n        (if (and (= (vector-ref sums2 0) (vector-ref sums2 1))\n                 (= (vector-ref sums2 0) (vector-ref sums2 2)))\n            #t\n            #f)\n        #f)))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (define (check_row row_index)\n      (define (check_row_helper row_index col_index)\n        (if (= col_index (length (car my_matrix)))\n            (if (= row_index (length my_matrix))\n                #t\n                (check_row (+ row_index 1)))\n            (if (= (list-ref (list-ref my_matrix row_index) col_index)\n                     (list-ref (list-ref my_matrix row_index) (+ col_index 1)))\n                (check_row_helper row_index (+ col_index 1))\n                #f)))\n      (check_row_helper row_index 0))\n    (define (check_col col_index)\n      (define (check_col_helper col_index row_index)\n        (if (= row_index (length my_matrix))\n            (if (= col_index (length (car my_matrix)))\n                #t\n                (check_col (+ col_index 1)))\n            (if (= (list-ref (list-ref my_matrix row_index) col_index)\n                     (list-ref (list-ref my_matrix (+ row_index 1)) col_index))\n                (check_col_helper col_index (+ row_index 1))\n                #f)))\n      (check_col_helper col_index 0))\n    (define (check_diag)\n      (define (check_diag_helper row_index col_index)\n        (if (= row_index (length my_matrix))\n            #t\n            (if (= (list-ref (list-ref my_matrix row_index) col_index)\n                     (list-ref (list-ref my_matrix (+ row_index 1)) (+ col_index 1)))\n                (check_diag_helper (+ row_index 1) (+ col_index 1))\n                #f)))\n      (check_diag_helper 0 0))\n    (define (check_anti_diag)\n      (define (check_anti_diag_helper row",
    "  (define (magic_square_test_helper my_matrix)\n    (define (sum_of_row my_matrix row)\n      (cond\n        [(empty? my_matrix) 0]\n        [else (+ (first (list-ref my_matrix row))\n                 (sum_of_row (rest my_matrix) row))]))\n    (define (sum_of_column my_matrix column)\n      (cond\n        [(empty? my_matrix) 0]\n        [else (+ (first (list-ref (first my_matrix) column))\n                 (sum_of_column (rest my_matrix) column))]))\n    (define (sum_of_diagonal my_matrix)\n      (cond\n        [(empty? my_matrix) 0]\n        [else (+ (first (first my_matrix))\n                 (sum_of_diagonal (map rest (rest my_matrix))))]))\n    (define (sum_of_reverse_diagonal my_matrix)\n      (cond\n        [(empty? my_matrix) 0]\n        [else (+ (first (last my_matrix))\n                 (sum_of_reverse_diagonal (map rest (rest my_matrix))))]))\n    (define (check_rows my_matrix)\n      (cond\n        [(empty? my_matrix) true]\n        [(= (sum_of_row my_matrix 0) (sum_of_row my_matrix 1))\n         (check_rows (rest my_matrix))]\n        [else false]))\n    (define (check_columns my_matrix)\n      (cond\n        [(empty? (first my_matrix)) true]\n        [(= (sum_of_column my_matrix 0) (sum_of_column my_matrix 1))\n         (check_columns (map rest my_matrix))]\n        [else false]))\n    (define (check_diagonals my_matrix)\n      (cond\n        [(empty? my_matrix) true]\n        [(= (sum_of_diagonal my_matrix) (sum_of_reverse_diagonal",
    "  (let ([n (length my_matrix)])\n    (let ([sum (apply + (map (lambda (x) (apply + x)) my_matrix))])\n      (and\n       (andmap (lambda (x) (= sum (apply + x))) my_matrix)\n       (andmap (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [magic_square? #t]\n         [magic_number (apply + (car my_matrix))])\n    (if (and (= n m)\n             (= n (length (car (cdr my_matrix)))))\n        (let loop ([i 0] [j 0])\n          (if (and magic_square?\n                   (&lt; i n))\n              (if (and magic_square?\n                       (&lt; j n))\n                  (if (= magic_number (apply + (map (lambda (x) (list-ref x j)) (sublist my_matrix i n))))\n                      (loop i (+ j 1))\n                      (set! magic_square? #f))\n                  (loop (+ i 1) 0))\n              magic_square?))\n        #f)))\n</code>\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix))))\n                 (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap\n          (lambda (row) (= sum (apply + row)))\n          my_matrix)\n         (andmap\n          (lambda (i) (= sum (apply + (map (lambda (row) (list-ref row i))\n                                           my_matrix))))\n          (range n))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i))\n                              (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i)))\n                              (range n)))))))\n",
    "  (let ([n (length my_matrix)])\n    (define (magic_square_test_helper my_matrix n)\n      (if (= n 1)\n          #t\n          (let ([sum (apply + (map (lambda (x) (list-ref x 0)) my_matrix))])\n            (and (= sum (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix)))\n                 (= sum (apply + (map (lambda (x) (list-ref x n)) my_matrix)))\n                 (= sum (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix)))\n                 (magic_square_test_helper (map (lambda (x) (cdr x)) my_matrix) (- n 1))))))\n    (magic_square_test_helper my_matrix n)))\n",
    "  (let ([n (length my_matrix)])\n    (let ([sum (apply + (list-ref my_matrix 0))])\n      (for ([i (in-range 1 n)])\n        (let ([row-sum (apply + (list-ref my_matrix i))])\n          (if (not (= row-sum sum))\n              (return #f))))\n      (for ([i (in-range n)])\n        (let ([col-sum (apply + (map (lambda (row) (list-ref row i)) my_matrix))])\n          (if (not (= col-sum sum))\n              (return #f))))\n      (let ([diag1 (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (in-range n)))])\n        (if (not (= diag1 sum))\n            (return #f)))\n      (let ([diag2 (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n i 1))) (in-range n)))])\n        (if (not (= diag2 sum))\n            (return #f)))\n      #t)))\n",
    "  (let ([n (length my_matrix)])\n    (let ([sum (apply + (list-ref my_matrix 0))])\n      (for/and ([i (in-range 1 n)])\n        (let ([row-sum (apply + (list-ref my_matrix i))])\n          (if (not (= row-sum sum))\n              #f\n              (let ([col-sum (apply + (map (lambda (x) (list-ref x i)) my_matrix))])\n                (if (not (= col-sum sum))\n                    #f\n                    (let ([diag-sum (apply + (map (lambda (x) (list-ref x x)) my_matrix))])\n                      (if (not (= diag-sum sum))\n                          #f\n                          (let ([diag-sum (apply + (map (lambda (x) (list-ref x (- n 1 x))) my_matrix))])\n                            (if (not (= diag-sum sum))\n                                #f\n                                #t)))))))))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (transpose my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals (reverse my_matrix))))\n            (* n (+ n 1) (/ n 2))))))\n",
    "  (define (magic_square_test_helper my_matrix row_sum)\n    (if (null? my_matrix)\n        (if (null? (cdr my_matrix))\n            #t\n            (if (= row_sum (apply + (car my_matrix)))\n                (magic_square_test_helper (cdr my_matrix) row_sum)\n                #f))\n        (magic_square_test_helper (cdr my_matrix) row_sum)))\n  (magic_square_test_helper my_matrix (apply + (car my_matrix))))\n",
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (sum (apply + (car my_matrix)))\n         (cols (for/list ([i (in-range m)])\n                   (apply + (for/list ([j (in-range n)])\n                              (list-ref (list-ref my_matrix j) i)))))\n         (diag1 (apply + (for/list ([i (in-range n)])\n                           (list-ref (list-ref my_matrix i) i))))\n         (diag2 (apply + (for/list ([i (in-range n)])\n                           (list-ref (list-ref my_matrix i) (- n i 1))))))\n    (and (= (length cols) m)\n         (= (length (remove (lambda (x) (= x sum)) cols)) 0)\n         (= diag1 sum)\n         (= diag2 sum))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range n))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (row) (apply + row)) my_matrix))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (col) (apply + col))\n                          (transpose my_matrix)))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i))\n                          (range n)))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n i 1)))\n                          (range n)))\n            (* n (/ (+ 1 (* n n)) 2))))))\n",
    "  (let ([n (length my_matrix)])\n    (let ([sum (apply + (map (lambda (x) (apply + x)) my_matrix))])\n      (and\n       (every (lambda (x) (= sum (apply + x))) my_matrix)\n       (every (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))))))\n",
    "  (let ([n (length my_matrix)])\n    (let ([magic_sum (/ (* n (+ n 1)) 2)])\n      (let ([row_sums (map (lambda (row) (apply + row)) my_matrix)])\n        (let ([col_sums (map (lambda (col) (apply + (map (lambda (row) (list-ref row col)) my_matrix))) (range n))])\n          (let ([diag_sums (list (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n)))\n                                 (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n))))])\n            (and (apply = row_sums)\n                 (apply = col_sums)\n                 (apply = diag_sums)\n                 (= magic_sum (apply + row_sums)))))))))\n",
    "  (let* ((n (array-length my_matrix))\n         (m (array-length (array-ref my_matrix 0))))\n    (and (= n m)\n         (= (apply + (array-ref my_matrix 0))\n            (apply + (array-ref my_matrix 1))\n            (apply + (array-ref my_matrix 2))\n            (apply + (array-ref my_matrix 3))\n            (apply + (array-ref my_matrix 4))\n            (apply + (array-ref my_matrix 5))\n            (apply + (array-ref my_matrix 6))\n            (apply + (array-ref my_matrix 7))\n            (apply + (array-ref my_matrix 8)))\n         (= (apply + (array-ref (array-ref my_matrix 0) 0)\n                    (array-ref (array-ref my_matrix 1) 1)\n                    (array-ref (array-ref my_matrix 2) 2)\n                    (array-ref (array-ref my_matrix 3) 3)\n                    (array-ref (array-ref my_matrix 4) 4)\n                    (array-ref (array-ref my_matrix 5) 5)\n                    (array-ref (array-ref my_matrix 6) 6)\n                    (array-ref (array-ref my_matrix 7) 7)\n                    (array-ref (array-ref my_matrix 8) 8))\n            (apply + (array-ref (array-ref my_matrix 0) 2)\n                    (array-ref (array-ref my_matrix 1) 1)\n                    (array-ref (array-ref my_matrix 2) 0)\n                    (array-ref (array-ref my_matrix 3) 7)\n                    (array-ref (array-ref my_matrix 4) 4)\n                    (array-ref (array-ref my_matrix 5) 3)\n                    (array-ref (array-ref my_matrix 6) 6)\n                    (array-ref (array-ref my_matrix 7) 5)\n                    (array-ref (array-ref my_matrix 8) 8)))))\n\n",
    "  (let ((n (length my_matrix)))\n    (let ((sum (apply + (map (lambda (x) (apply + x)) my_matrix))))\n      (let ((rows (map (lambda (x) (apply + x)) my_matrix))\n            (cols (map (lambda (x) (apply + (map (lambda (y) (list-ref y x)) my_matrix))) (range n))))\n        (let ((diag1 (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) x)) (range n))))\n              (diag2 (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) (- n 1 x))) (range n)))))\n          (and (apply = rows)\n               (apply = cols)\n               (= diag1 sum)\n               (= diag2 sum)))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (transpose my_matrix)))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals my_matrix)))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals (reverse my_matrix))))\n            (* n (/ (+ 1 (* n n)) 2))))))\n",
    "  (let ([n (length my_matrix)])\n    (let ([m (length (car my_matrix))])\n      (let ([sum (apply + (car my_matrix))])\n        (and (= n m)\n             (every (lambda (row) (= sum (apply + row))) my_matrix)\n             (every (lambda (col) (= sum (apply + col)))\n                    (map (lambda (col) (map (lambda (row) (list-ref row col)) my_matrix))\n                         (range n))))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [row_sum (apply + (car my_matrix))]\n         [col_sum (apply + (map (lambda (x) (list-ref x 0)) my_matrix))]\n         [diag_sum (apply + (map (lambda (x y) (list-ref x y)) my_matrix (range 0 n)))]\n         [anti_diag_sum (apply + (map (lambda (x y) (list-ref x y)) my_matrix (reverse (range 0 n))))])\n    (and (= row_sum col_sum)\n         (= row_sum diag_sum)\n         (= row_sum anti_diag_sum))))\n",
    "  (let ((n (length my_matrix)))\n    (and\n     (and (= n (length (car my_matrix)))\n          (andmap (lambda (row) (= n (length row))) my_matrix))\n     (andmap (lambda (row) (= (apply + row) (/ (* n (+ n 1)) 2))) my_matrix)\n     (andmap (lambda (col) (= (apply + col) (/ (* n (+ n 1)) 2)))\n             (transpose my_matrix))\n     (andmap (lambda (diag) (= (apply + diag) (/ (* n (+ n 1)) 2)))\n             (list (diagonal my_matrix) (diagonal (reverse my_matrix)))))))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (define (sum_of_row my_matrix row)\n      (define (sum_of_row_helper my_matrix row sum)\n        (if (equal? row (length my_matrix))\n            sum\n            (sum_of_row_helper my_matrix (+ row 1) (+ sum (list-ref (list-ref my_matrix row) row)))))\n      (sum_of_row_helper my_matrix row 0))\n    (define (sum_of_col my_matrix col)\n      (define (sum_of_col_helper my_matrix col sum)\n        (if (equal? col (length my_matrix))\n            sum\n            (sum_of_col_helper my_matrix (+ col 1) (+ sum (list-ref (list-ref my_matrix col) col)))))\n      (sum_of_col_helper my_matrix col 0))\n    (define (sum_of_diagonal my_matrix)\n      (define (sum_of_diagonal_helper my_matrix sum)\n        (if (equal? (length my_matrix) 0)\n            sum\n            (sum_of_diagonal_helper (cdr my_matrix) (+ sum (list-ref (car my_matrix) 0)))))\n      (sum_of_diagonal_helper my_matrix 0))\n    (define (sum_of_reverse_diagonal my_matrix)\n      (define (sum_of_reverse_diagonal_helper my_matrix sum)\n        (if (equal? (length my_matrix) 0)\n            sum\n            (sum_of_reverse_diagonal_helper (cdr my_matrix) (+ sum (list-ref (car my_matrix) (- (length my_matrix) 1))))))\n      (sum_of_reverse_diagonal_helper my_matrix 0))\n    (define (sum_of_row_col my_matrix row col)\n      (define (sum_of_row_col_helper my_matrix row col",
    "  (let ([n (length my_matrix)])\n    (let ([sum (apply + (list-ref my_matrix 0))])\n      (for/and ([i (in-range n)])\n        (let ([row-sum (apply + (list-ref my_matrix i))])\n          (and (= row-sum sum)\n               (let ([col-sum (apply + (map (lambda (row) (list-ref row i)) my_matrix))])\n                 (= col-sum sum))))))))\n",
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (sum (apply + (car my_matrix))))\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + col))) (transpose my_matrix))\n         (= sum (apply + (diagonal my_matrix)))\n         (= sum (apply + (diagonal (reverse my_matrix)))))))\n",
    "  (let ([n (length my_matrix)])\n    (let ([sum (apply + (list-ref my_matrix 0))])\n      (for ([i (in-range 1 n)])\n        (if (not (= sum (apply + (list-ref my_matrix i))))\n            (return #f)))\n      (for ([i (in-range n)])\n        (if (not (= sum (apply + (map (lambda (x) (list-ref x i)) my_matrix))))\n            (return #f)))\n      (if (not (= sum (apply + (map (lambda (x) (list-ref x x)) my_matrix))))\n          (return #f))\n      (if (not (= sum (apply + (map (lambda (x) (list-ref x (- n 1 x))) my_matrix))))\n          (return #f))\n      #t)))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (map (lambda (x) (apply + x)) my_matrix))]\n         [diag1 (apply + (map (lambda (x y) (list-ref (list-ref my_matrix x) y)) (build-list n (lambda (x) x)) (build-list n (lambda (x) x))))]\n         [diag2 (apply + (map (lambda (x y) (list-ref (list-ref my_matrix x) y)) (build-list n (lambda (x) x)) (build-list n (lambda (x) (- n 1 x)))))]\n         [cols (map (lambda (x) (apply + (map (lambda (y) (list-ref y x)) my_matrix))) (build-list m (lambda (x) x)))]\n         [rows (map (lambda (x) (apply + x)) my_matrix)])\n    (and (= n m)\n         (= sum (apply + cols))\n         (= sum (apply + rows))\n         (= sum diag1)\n         (= sum diag2))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (let ([sum (apply + (car my_matrix))])\n           (andmap (lambda (row) (= sum (apply + row))) my_matrix))\n         (let ([sum (apply + (map (lambda (i) (list-ref (car my_matrix) i)) (range n)))]\n                [sum2 (apply + (map (lambda (i) (list-ref (car my_matrix) i)) (reverse (range n))))])\n           (and (= sum sum2)\n                (andmap (lambda (i) (= sum (apply + (map (lambda (row) (list-ref row i)) my_matrix))))\n                        (range n)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (every (lambda (row) (= sum (apply + row))) my_matrix)\n         (every (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix))))\n                (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (every (lambda (row) (= sum (apply + row))) my_matrix)\n         (every (lambda (col) (= sum (apply + col))) (transpose my_matrix))\n         (= sum (+ (apply + (diagonal my_matrix))\n                   (apply + (diagonal (reverse my_matrix))))))))\n",
    "  (let ([n (length my_matrix)]\n        [sum (apply + (map (lambda (x) (apply + x)) my_matrix))])\n    (and (= n (length (car my_matrix)))\n         (= sum (apply + (map (lambda (x) (apply + x)) (transpose my_matrix))))\n         (= sum (apply + (map (lambda (x) (apply + x)) (diagonals my_matrix)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [s (sum (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= s (sum row))) my_matrix)\n         (andmap (lambda (col) (= s (sum col))) (transpose my_matrix))\n         (= s (+ (sum (diagonal my_matrix))\n                 (sum (diagonal (reverse my_matrix))))))))\n",
    "  (let ((n (length my_matrix)))\n    (let ((sum (apply + (map (lambda (x) (apply + x)) my_matrix))))\n      (and\n       (= sum (/ (* n (+ n 1) (* n n)) 2))\n       (andmap (lambda (x) (= sum (apply + x))) my_matrix)\n       (andmap (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))))))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (cond\n      [(empty? my_matrix) #t]\n      [(not (equal? (length (first my_matrix)) (length my_matrix))) #f]\n      [(not (equal? (sum_of_row my_matrix) (sum_of_row (transpose my_matrix)))) #f]\n      [(not (equal? (sum_of_row my_matrix) (sum_of_diagonal my_matrix))) #f]\n      [(not (equal? (sum_of_row my_matrix) (sum_of_diagonal (reverse_matrix my_matrix)))) #f]\n      [else (magic_square_test_helper (rest my_matrix))]))\n  (magic_square_test_helper my_matrix))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (transpose my_matrix)))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals my_matrix)))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals (reverse my_matrix))))\n            (* n (/ (+ 1 (* n n)) 2))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (andmap (lambda (x) (= n (length x))) my_matrix)\n         (andmap (lambda (x) (= (apply + x) (* n (+ 1 (quotient n 2)))))\n                 my_matrix)\n         (andmap (lambda (x) (= (apply + x) (* n (+ 1 (quotient n 2)))))\n                 (transpose my_matrix))\n         (= (apply + (map (lambda (x) (list-ref x 0)) my_matrix))\n            (* n (+ 1 (quotient n 2))))\n         (= (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix))\n            (* n (+ 1 (quotient n 2)))))))\n",
    "  (define (magic_square_test_aux my_matrix)\n    (define (sum_of_row my_matrix row)\n      (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n    (define (sum_of_col my_matrix col)\n      (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n    (define (sum_of_diag my_matrix)\n      (apply + (map (lambda (x) (vector-ref x x)) my_matrix)))\n    (define (sum_of_diag_inv my_matrix)\n      (apply + (map (lambda (x) (vector-ref x (- (vector-length my_matrix) x 1))) my_matrix)))\n    (define (sum_of_all my_matrix)\n      (apply + (map (lambda (x) (apply + x)) my_matrix)))\n    (define (sum_of_all_rows my_matrix)\n      (map (lambda (x) (sum_of_row my_matrix x)) (range (vector-length my_matrix))))\n    (define (sum_of_all_cols my_matrix)\n      (map (lambda (x) (sum_of_col my_matrix x)) (range (vector-length my_matrix))))\n    (define (sum_of_all_diags my_matrix)\n      (list (sum_of_diag my_matrix) (sum_of_diag_inv my_matrix)))\n    (define (sum_of_all_lists my_matrix)\n      (append (sum_of_all_rows my_matrix) (sum_of_all_cols my_matrix) (sum_of_all_diags my_matrix)))\n    (define (all_equal? my_list)\n      (cond ((null? (cdr my_list)) #t)\n            ((equal? (car my_list) (cadr my_list)) (all_equal? (cdr my_list)))\n            (else #f)))\n    (all_equal? (sum",
    "  (let ((n (length my_matrix)))\n    (let ((magic_number (* n (+ n 1) (/ (+ n 1) 2))))\n      (and\n       (andmap (lambda (x) (= magic_number (apply + x))) my_matrix)\n       (andmap (lambda (x) (= magic_number (apply + x))) (transpose my_matrix))\n       (= magic_number (apply + (diagonal my_matrix)))\n       (= magic_number (apply + (diagonal (reverse my_matrix))))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (andmap (lambda (x) (= n (length x))) my_matrix)\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (transpose my_matrix)))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals my_matrix)))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals (reverse my_matrix))))\n            (* n (/ (+ 1 (* n n)) 2))))))\n",
    "  (define (sum_row my_matrix row)\n    (apply + (map (lambda (x) (list-ref x row)) my_matrix)))\n  (define (sum_column my_matrix column)\n    (apply + (map (lambda (x) (list-ref x column)) my_matrix)))\n  (define (sum_diagonal my_matrix)\n    (apply + (map (lambda (x y) (list-ref x y)) my_matrix (range (length my_matrix)))))\n  (define (sum_reverse_diagonal my_matrix)\n    (apply + (map (lambda (x y) (list-ref x y)) my_matrix (reverse (range (length my_matrix))))))\n  (define (sum_all_rows my_matrix)\n    (map (lambda (x) (sum_row my_matrix x)) (range (length my_matrix))))\n  (define (sum_all_columns my_matrix)\n    (map (lambda (x) (sum_column my_matrix x)) (range (length my_matrix))))\n  (define (sum_all_diagonals my_matrix)\n    (list (sum_diagonal my_matrix) (sum_reverse_diagonal my_matrix)))\n  (define (sum_all_lists my_matrix)\n    (append (sum_all_rows my_matrix) (sum_all_columns my_matrix) (sum_all_diagonals my_matrix)))\n  (define (all_equal? my_list)\n    (cond ((null? (cdr my_list)) #t)\n          ((equal? (car my_list) (car (cdr my_list))) (all_equal? (cdr my_list)))\n          (else #f)))\n  (all_equal? (sum_all_lists my_matrix)))\n",
    "  (let ((n (length my_matrix)))\n    (let ((m (length (car my_matrix))))\n      (if (and (= n m)\n               (= n (length (car (cdr my_matrix)))))\n          (let ((sum (apply + (car my_matrix))))\n            (let ((sum_list (list sum)))\n              (let loop ((i 1) (j 0))\n                (if (= i n)\n                    (if (apply = sum_list)\n                        (let ((sum_list (list sum)))\n                          (let loop ((i 0) (j 1))\n                            (if (= j n)\n                                (if (apply = sum_list)\n                                    #t\n                                    #f)\n                                (let ((sum (apply + (map (lambda (x) (list-ref x j)) my_matrix))))\n                                  (set! sum_list (append sum_list (list sum)))\n                                  (loop i (+ j 1))))))\n                        #f)\n                    (let ((sum (apply + (map (lambda (x) (list-ref x i)) my_matrix))))\n                      (set! sum_list (append sum_list (list sum)))\n                      (loop (+ i 1) j))))))\n          #f)))))\n",
    "  (let ((n (length my_matrix)))\n    (let ((sum (apply + (list-ref my_matrix 0))))\n      (let loop ((i 1))\n        (if (= i n)\n            #t\n            (if (= sum (apply + (list-ref my_matrix i)))\n                (loop (+ i 1))\n                #f))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= sum (apply + (map (lambda (row) (list-ref row (- n 1))) my_matrix)))\n         (= sum (apply + (map (lambda (row) (list-ref row 0)) my_matrix))))))\n",
    "  (let ((n (length my_matrix)))\n    (let ((row-sum (apply + (map (lambda (row) (apply + row)) my_matrix))))\n      (let ((col-sum (apply + (map (lambda (col) (apply + col)) (transpose my_matrix)))))\n        (let ((diag-sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n)))))\n          (let ((diag-sum2 (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n i 1))) (range n)))))\n            (and (= row-sum col-sum)\n                 (= row-sum diag-sum)\n                 (= row-sum diag-sum2))))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range n))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix (- n 1 i)) i)) (range n)))))))\n",
    "  (let* ([sum (apply + (car my_matrix))]\n         [row_sums (map (lambda (row) (apply + row)) my_matrix)])\n    (and (= (length (remove (lambda (x) (= x sum)) row_sums)) 0)\n         (= (length (remove (lambda (x) (= x sum)) (apply map list my_matrix))) 0)\n         (= (length (remove (lambda (x) (= x sum)) (apply map list (transpose my_matrix)))) 0)\n         (= (length (remove (lambda (x) (= x sum)) (diagonal my_matrix))) 0)\n         (= (length (remove (lambda (x) (= x sum)) (diagonal (reverse my_matrix)))) 0))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum_row (make-vector n 0)]\n         [sum_col (make-vector m 0)]\n         [sum_diag1 0]\n         [sum_diag2 0])\n    (for ([i (in-range n)])\n      (for ([j (in-range m)])\n        (vector-set! sum_row i (+ (vector-ref sum_row i) (vector-ref (vector-ref my_matrix i) j)))\n        (vector-set! sum_col j (+ (vector-ref sum_col j) (vector-ref (vector-ref my_matrix i) j)))\n        (when (= i j)\n          (set! sum_diag1 (+ sum_diag1 (vector-ref (vector-ref my_matrix i) j))))\n        (when (= i (- n j 1))\n          (set! sum_diag2 (+ sum_diag2 (vector-ref (vector-ref my_matrix i) j))))))\n    (and (= (vector-ref sum_row 0) sum_diag1)\n         (= (vector-ref sum_row 0) sum_diag2)\n         (for/and ([i (in-range n)])\n                  (= (vector-ref sum_row 0) (vector-ref sum_row i)))\n         (for/and ([j (in-range m)])\n                  (= (vector-ref sum_row 0) (vector-ref sum_col j))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (let ([row-sums (map (lambda (row) (apply + row)) my_matrix)])\n           (and (= (apply + row-sums) (* n (/ (+ n 1) 2)))\n                (let ([col-sums (map (lambda (col) (apply + (map (lambda (row) (list-ref row col)) my_matrix))) (range n))])\n                  (and (= (apply + col-sums) (* n (/ (+ n 1) 2)))\n                       (let ([diag-sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n)))])\n                         (and (= diag-sum (* n (/ (+ n 1) 2)))\n                              (let ([diag-sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))])\n                                (= diag-sum (* n (/ (+ n 1) 2)))))))))))))\n",
    "  (define (sum_row my_matrix row)\n    (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n  (define (sum_col my_matrix col)\n    (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n  (define (sum_diag my_matrix)\n    (apply + (map (lambda (x) (vector-ref x x)) my_matrix)))\n  (define (sum_diag_rev my_matrix)\n    (apply + (map (lambda (x) (vector-ref x (- (vector-length my_matrix) x 1))) my_matrix)))\n  (define (sum_all_rows my_matrix)\n    (map (lambda (x) (sum_row my_matrix x)) (range (vector-length my_matrix))))\n  (define (sum_all_cols my_matrix)\n    (map (lambda (x) (sum_col my_matrix x)) (range (vector-length my_matrix))))\n  (define (sum_all_diags my_matrix)\n    (list (sum_diag my_matrix) (sum_diag_rev my_matrix)))\n  (define (sum_all_lists my_matrix)\n    (append (sum_all_rows my_matrix) (sum_all_cols my_matrix) (sum_all_diags my_matrix)))\n  (define (all_equal? my_list)\n    (cond ((null? (cdr my_list)) #t)\n          ((equal? (car my_list) (cadr my_list)) (all_equal? (cdr my_list)))\n          (else #f)))\n  (all_equal? (sum_all_lists my_matrix)))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (every (lambda (row) (= sum (apply + row))) my_matrix)\n         (every (lambda (col) (= sum (apply + col))) (transpose my_matrix))\n         (= sum (apply + (diagonal my_matrix)))\n         (= sum (apply + (diagonal (reverse my_matrix)))))))\n",
    "  (define (sum_of_row my_matrix row)\n    (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n  (define (sum_of_column my_matrix column)\n    (apply + (map (lambda (x) (vector-ref x column)) my_matrix)))\n  (define (sum_of_diagonal my_matrix)\n    (apply + (map (lambda (x) (vector-ref x x)) my_matrix)))\n  (define (sum_of_reverse_diagonal my_matrix)\n    (apply + (map (lambda (x) (vector-ref x (- (vector-length x) x 1))) my_matrix)))\n  (define (sum_of_all_rows my_matrix)\n    (map (lambda (x) (sum_of_row my_matrix x)) (range (vector-length (vector-ref my_matrix 0)))))\n  (define (sum_of_all_columns my_matrix)\n    (map (lambda (x) (sum_of_column my_matrix x)) (range (vector-length (vector-ref my_matrix 0)))))\n  (define (sum_of_all_diagonals my_matrix)\n    (list (sum_of_diagonal my_matrix) (sum_of_reverse_diagonal my_matrix)))\n  (define (sum_of_all_elements my_matrix)\n    (append (sum_of_all_rows my_matrix) (sum_of_all_columns my_matrix) (sum_of_all_diagonals my_matrix)))\n  (define (all_elements_equal? my_list)\n    (cond ((null? (cdr my_list)) #t)\n          ((equal? (car my_list) (cadr my_list)) (all_elements_equal? (cdr my_list)))\n          (else #f)))\n  (all_elements_equal? (sum_of_all_elements my_matrix)))\n",
    "  (let ([n (length my_matrix)])\n    (let ([sum (apply + (map (lambda (x) (apply + x)) my_matrix))])\n      (and\n       (andmap (lambda (x) (= sum (apply + x))) my_matrix)\n       (andmap (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))))))\n",
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (sum (apply + (car my_matrix))))\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range n))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let ([n (length my_matrix)])\n    (and\n     (andmap (lambda (row) (= (apply + row) (* n (+ n 1) (/ n 2)))) my_matrix)\n     (andmap (lambda (col) (= (apply + col) (* n (+ n 1) (/ n 2)))) (transpose my_matrix))\n     (= (apply + (diagonal my_matrix)) (* n (+ n 1) (/ n 2)))\n     (= (apply + (diagonal (reverse my_matrix))) (* n (+ n 1) (/ n 2))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [s (sum (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (x) (= s (sum x))) my_matrix)\n         (andmap (lambda (x) (= s (sum (map sum (transpose my_matrix)))))\n                 (range n)))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range n))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let ((n (length my_matrix)))\n    (and (= n (length (car my_matrix)))\n         (let ((sum (apply + (car my_matrix))))\n           (andmap (lambda (row) (= sum (apply + row)))\n                   (cdr my_matrix))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [s (sum_of_row my_matrix 0)])\n    (and (= n m)\n         (= (sum_of_row my_matrix 0) s)\n         (= (sum_of_row my_matrix 1) s)\n         (= (sum_of_row my_matrix 2) s)\n         (= (sum_of_column my_matrix 0) s)\n         (= (sum_of_column my_matrix 1) s)\n         (= (sum_of_column my_matrix 2) s)\n         (= (sum_of_diagonal my_matrix) s)\n         (= (sum_of_diagonal (reverse_matrix my_matrix)) s))))\n",
    "  (define (sum_row my_matrix row)\n    (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n  (define (sum_col my_matrix col)\n    (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n  (define (sum_diag my_matrix)\n    (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range (vector-length (vector-ref my_matrix 0)) 0 -1))))\n  (define (sum_antidiag my_matrix)\n    (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range 0 (vector-length (vector-ref my_matrix 0))))))\n  (define (sum_all_rows my_matrix)\n    (map (lambda (x) (sum_row my_matrix x)) (range (vector-length (vector-ref my_matrix 0)))))\n  (define (sum_all_cols my_matrix)\n    (map (lambda (x) (sum_col my_matrix x)) (range (vector-length (vector-ref my_matrix 0)))))\n  (define (sum_all_diags my_matrix)\n    (list (sum_diag my_matrix) (sum_antidiag my_matrix)))\n  (define (sum_all_sums my_matrix)\n    (append (sum_all_rows my_matrix) (sum_all_cols my_matrix) (sum_all_diags my_matrix)))\n  (define (all_equal? my_list)\n    (cond ((null? (cdr my_list)) #t)\n          ((equal? (car my_list) (cadr my_list)) (all_equal? (cdr my_list)))\n          (else #f)))\n  (all_equal? (sum_all_sums my_matrix)))\n",
    "  (let ([n (length my_matrix)])\n    (let ([sum (apply + (list-ref my_matrix 0))])\n      (let loop ([i 1])\n        (if (= i n)\n            (let loop ([j 0])\n              (if (= j n)\n                  (let loop ([i 0])\n                    (if (= i n)\n                        (let loop ([j 0])\n                          (if (= j n)\n                              #t\n                              (if (= (apply + (map (lambda (x) (list-ref x j)) my_matrix)) sum)\n                                  (loop (+ j 1))\n                                  #f)))\n                          (loop (+ i 1))))\n                      (if (= (apply + (list-ref my_matrix j)) sum)\n                          (loop (+ j 1))\n                          #f)))\n                  #f))\n            (if (= (apply + (list-ref my_matrix i)) sum)\n                (loop (+ i 1))\n                #f))))))\n",
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (sum (apply + (car my_matrix))))\n    (and (= n m)\n         (apply = (map (lambda (row) (apply + row)) my_matrix))\n         (apply = (map (lambda (col) (apply + col)) (transpose my_matrix)))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (define (sum_row my_matrix row)\n      (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n    (define (sum_col my_matrix col)\n      (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n    (define (sum_diag my_matrix)\n      (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range (vector-length (vector-ref my_matrix 0)) 0 -1))))\n    (define (sum_diag2 my_matrix)\n      (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range (vector-length (vector-ref my_matrix 0))))))\n    (define (sum_all my_matrix)\n      (apply + (map (lambda (x) (apply + x)) my_matrix)))\n    (define (check_row my_matrix)\n      (define (check_row_helper my_matrix row)\n        (if (= row (vector-length my_matrix))\n            #t\n            (if (= (sum_row my_matrix row) (sum_all my_matrix))\n                (check_row_helper my_matrix (+ row 1))\n                #f)))\n      (check_row_helper my_matrix 0))\n    (define (check_col my_matrix)\n      (define (check_col_helper my_matrix col)\n        (if (= col (vector-length (vector-ref my_matrix 0)))\n            #t\n            (if (= (sum_col my_matrix col) (sum_all my_matrix))\n                (check_col_helper my_matrix (+ col 1))\n                #f)))\n      (check_col_helper my_matrix 0))\n    (define (check_diag my_matrix)\n      (if (= (sum_diag my_matrix) (sum_all my_matrix))\n          #t\n         ",
    "  (define (magic_square_test_helper my_matrix row_sum)\n    (if (null? (car my_matrix))\n        (if (null? (cdr my_matrix))\n            (if (= row_sum (apply + (car my_matrix)))\n                #t\n                #f)\n            (magic_square_test_helper (cdr my_matrix) (apply + (car my_matrix))))\n        (magic_square_test_helper (map cdr my_matrix) row_sum)))\n  (magic_square_test_helper my_matrix 0))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (let ([sum (apply + (car my_matrix))])\n           (and (apply = (map (lambda (row) (apply + row)) my_matrix))\n                (apply = (map (lambda (col) (apply + (map (lambda (row) (list-ref row col)) my_matrix))) (range n)))\n                (and (= sum (apply + (map (lambda (row) (list-ref row row)) my_matrix)))\n                     (= sum (apply + (map (lambda (row) (list-ref row (- n 1 row))) my_matrix)))))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix))))\n                 (range m))\n         (= sum (apply + (map (lambda (row) (list-ref row (- n 1))) my_matrix)))\n         (= sum (apply + (map (lambda (row) (list-ref row 0)) my_matrix))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let ([n (length my_matrix)])\n    (for/and ([i (in-range n)])\n      (let ([row-sum (apply + (vector-ref my_matrix i))])\n        (for/and ([j (in-range n)])\n          (let ([col-sum (apply + (vector-ref (transpose my_matrix) j))])\n            (and (= row-sum col-sum)\n                 (= row-sum (apply + (diagonal my_matrix i j)))\n                 (= row-sum (apply + (diagonal my_matrix (- n 1 i) j))))))))))\n",
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (sum (apply + (car my_matrix))))\n    (and (= n m)\n         (andmap (lambda (x) (= sum (apply + x))) my_matrix)\n         (andmap (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))\n         (= sum (apply + (map (lambda (x) (list-ref (car my_matrix) x)) (range n))))\n         (= sum (apply + (map (lambda (x) (list-ref (car my_matrix) (- n 1 x))) (range n)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range n))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (sum (apply + (car my_matrix))))\n    (and (= n m)\n         (apply = (map (lambda (x) (apply + x)) my_matrix))\n         (apply = (map (lambda (x) (apply + (map (lambda (y) (list-ref y x)) my_matrix))) (range n)))\n         (apply = (map (lambda (x) (apply + (map (lambda (y) (list-ref y y)) (submatrix my_matrix x x n)))) (range n)))\n         (apply = (map (lambda (x) (apply + (map (lambda (y) (list-ref y (- n 1 y))) (submatrix my_matrix x x n)))) (range n)))\n         (= sum (apply + (map (lambda (x) (list-ref x (- n 1))) (submatrix my_matrix 0 0 n)))))))\n",
    "  (let* ((rows (matrix-rows my_matrix))\n         (cols (matrix-cols my_matrix))\n         (row-sums (map (lambda (row) (apply + row)) rows))\n         (col-sums (map (lambda (col) (apply + col)) cols))\n         (diag-sums (list (apply + (matrix-diagonal my_matrix))\n                          (apply + (matrix-diagonal (matrix-transpose my_matrix)))))\n         (sum-set (set row-sums)))\n    (and (= (length sum-set) 1)\n         (set=? sum-set col-sums)\n         (set=? sum-set diag-sums))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [magic_sum (apply + (car my_matrix))])\n    (and (= n m)\n         (every (lambda (row) (= magic_sum (apply + row))) my_matrix)\n         (every (lambda (col) (= magic_sum (apply + col)))\n                (transpose my_matrix))\n         (= magic_sum (apply + (diagonal my_matrix)))\n         (= magic_sum (apply + (diagonal (reverse my_matrix)))))))\n",
    "  (let ([n (length my_matrix)])\n    (and\n     (= n (length (car my_matrix)))\n     (= (apply + (car my_matrix)) (/ (* n (+ n 1)) 2))\n     (let loop ([i 0] [sum (apply + (car my_matrix))])\n       (cond\n         [(= i n) (= sum (apply + (car my_matrix)))]\n         [else\n          (loop (+ i 1)\n                (+ sum (car (my_matrix i))))]))\n     (let loop ([i 0] [sum (apply + (car my_matrix))])\n       (cond\n         [(= i n) (= sum (apply + (car my_matrix)))]\n         [else\n          (loop (+ i 1)\n                (+ sum (my_matrix i 0)))]))\n     (let loop ([i 0] [sum (apply + (car my_matrix))])\n       (cond\n         [(= i n) (= sum (apply + (car my_matrix)))]\n         [else\n          (loop (+ i 1)\n                (+ sum (my_matrix (- n 1) i)))]))\n     (let loop ([i 0] [sum (apply + (car my_matrix))])\n       (cond\n         [(= i n) (= sum (apply + (car my_matrix)))]\n         [else\n          (loop (+ i 1)\n                (+ sum (my_matrix i (- n 1))))])))))\n",
    "  (let ((n (length my_matrix)))\n    (let ((magic_number (* n (+ 1 (/ n 2)))))\n      (let ((row_sums (map (lambda (row) (apply + row)) my_matrix)))\n        (let ((col_sums (map (lambda (col) (apply + col)) (transpose my_matrix))))\n          (let ((diag_sums (list (apply + (diagonal my_matrix))\n                                 (apply + (diagonal (reverse my_matrix))))))\n            (and (= (apply + row_sums) magic_number)\n                 (= (apply + col_sums) magic_number)\n                 (= (apply + diag_sums) magic_number))))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [magic_sum (apply + (range 1 (+ n 1)))]\n         [row_sums (map (lambda (row) (apply + row)) my_matrix)]\n         [col_sums (map (lambda (col) (apply + (map (lambda (row) (list-ref row col)) my_matrix))) (range 0 m))]\n         [diag_sums (list (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range 0 n)))\n                          (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range 0 n))))])\n    (and (= (length row_sums) n)\n         (= (length col_sums) m)\n         (= (length diag_sums) 2)\n         (every (lambda (x) (= x magic_sum)) (append row_sums col_sums diag_sums)))))\n",
    "  (let* ([m (length my_matrix)]\n         [n (length (car my_matrix))]\n         [s (sum_matrix my_matrix)]\n         [s1 (sum_matrix (transpose my_matrix))]\n         [s2 (sum_matrix (diagonal my_matrix))]\n         [s3 (sum_matrix (diagonal (reverse my_matrix)))]\n         [s4 (sum_matrix (diagonal (transpose my_matrix)))])\n    (and (= s s1) (= s s2) (= s s3) (= s s4))))\n",
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (sum (apply + (car my_matrix)))\n         (sum_rows (map (lambda (row) (apply + row)) my_matrix))\n         (sum_cols (map (lambda (col) (apply + col)) (transpose my_matrix)))\n         (sum_diag1 (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (sum_diag2 (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))\n    (and (= n m)\n         (= sum sum_rows)\n         (= sum sum_cols)\n         (= sum sum_diag1)\n         (= sum sum_diag2))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (let ([sum (apply + (car my_matrix))])\n           (andmap (lambda (row) (= sum (apply + row)))\n                   (cdr my_matrix))))))\n",
    "  (let ((n (length my_matrix)))\n    (and\n     (= (apply + (map (lambda (x) (apply + x)) my_matrix)) (* n (/ (+ 1 (* n n)) 2)))\n     (= (apply + (map (lambda (x) (apply + (map (lambda (y) (list-ref y x)) my_matrix))) my_matrix)) (* n (/ (+ 1 (* n n)) 2))))))\n",
    "  (let ([n (length my_matrix)])\n    (define (sum_row row)\n      (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n    (define (sum_col col)\n      (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n    (define (sum_diag)\n      (apply + (map (lambda (x) (vector-ref x x)) my_matrix)))\n    (define (sum_anti-diag)\n      (apply + (map (lambda (x) (vector-ref x (- n 1 x))) my_matrix)))\n    (define (sum_all)\n      (apply + (map sum_row my_matrix)))\n    (define (sum_all_col)\n      (apply + (map sum_col my_matrix)))\n    (define (sum_all_diag)\n      (apply + (map sum_diag my_matrix)))\n    (define (sum_all_anti-diag)\n      (apply + (map sum_anti-diag my_matrix)))\n    (define (sum_all_all)\n      (apply + (map sum_all my_matrix)))\n    (define (sum_all_all_col)\n      (apply + (map sum_all_col my_matrix)))\n    (define (sum_all_all_diag)\n      (apply + (map sum_all_diag my_matrix)))\n    (define (sum_all_all_anti-diag)\n      (apply + (map sum_all_anti-diag my_matrix)))\n    (define (sum_all_all_all)\n      (apply + (map sum_all_all my_matrix)))\n    (define (sum_all_all_all_col)\n      (apply + (map sum_all_all_col my_matrix)))\n    (define (sum_all_all_all_diag)\n      (apply + (map sum_all_all_diag my_matrix)))\n    (define (sum_all_all_all_anti-diag)\n      (apply +",
    "  (define (magic_square_test_helper my_matrix)\n    (define (sum_row my_matrix row)\n      (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n    (define (sum_col my_matrix col)\n      (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n    (define (sum_diag my_matrix)\n      (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range (vector-length (vector-ref my_matrix 0)) -1 -1))))\n    (define (sum_anti_diag my_matrix)\n      (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range 0 (vector-length (vector-ref my_matrix 0))))))\n    (define (sum_all_rows my_matrix)\n      (map (lambda (x) (sum_row my_matrix x)) (range 0 (vector-length (vector-ref my_matrix 0)))))\n    (define (sum_all_cols my_matrix)\n      (map (lambda (x) (sum_col my_matrix x)) (range 0 (vector-length (vector-ref my_matrix 0)))))\n    (define (sum_all_diags my_matrix)\n      (list (sum_diag my_matrix) (sum_anti_diag my_matrix)))\n    (define (sum_all my_matrix)\n      (append (sum_all_rows my_matrix) (sum_all_cols my_matrix) (sum_all_diags my_matrix)))\n    (define (all_equal? my_list)\n      (define (all_equal_helper my_list)\n        (if (null? (cdr my_list))\n            #t\n            (if (equal? (car my_list) (cadr my_list))\n                (all_equal_helper (cdr my_list))\n                #f)))\n      (all_equal_helper my_list))\n   ",
    "  (let ([n (length my_matrix)])\n    (and (andmap (lambda (x) (= n (length x))) my_matrix)\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (transpose my_matrix)))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (list-ref x x)) my_matrix))\n            (* n (/ (+ 1 (* n n)) 2)))\n         (= (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix))\n            (* n (/ (+ 1 (* n n)) 2))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (magic_number (apply + (range 1 (+ n 1))))\n         (row_sums (map (lambda (row) (apply + row)) my_matrix))\n         (col_sums (map (lambda (col) (apply + (map (lambda (row) (list-ref row col)) my_matrix))) (range 0 m)))\n         (diag_sums (list (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range 0 n)))\n                          (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range 0 n))))))\n    (and (andmap (lambda (x) (= x magic_number)) (append row_sums col_sums diag_sums))\n         (= n m))))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (define (sum_row my_matrix row)\n      (define (sum_row_helper my_matrix row sum)\n        (if (null? (car my_matrix))\n            sum\n            (sum_row_helper (cdr my_matrix) row (+ sum (list-ref (car my_matrix) row)))\n        )\n      )\n      (sum_row_helper my_matrix row 0)\n    )\n    (define (sum_column my_matrix column)\n      (define (sum_column_helper my_matrix column sum)\n        (if (null? my_matrix)\n            sum\n            (sum_column_helper (cdr my_matrix) column (+ sum (list-ref (car my_matrix) column)))\n        )\n      )\n      (sum_column_helper my_matrix column 0)\n    )\n    (define (sum_diagonal my_matrix diagonal)\n      (define (sum_diagonal_helper my_matrix diagonal sum)\n        (if (null? my_matrix)\n            sum\n            (sum_diagonal_helper (cdr my_matrix) diagonal (+ sum (list-ref (car my_matrix) diagonal)))\n        )\n      )\n      (sum_diagonal_helper my_matrix diagonal 0)\n    )\n    (define (sum_diagonal_reverse my_matrix diagonal)\n      (define (sum_diagonal_reverse_helper my_matrix diagonal sum)\n        (if (null? my_matrix)\n            sum\n            (sum_diagonal_reverse_helper (cdr my_matrix) diagonal (+ sum (list-ref (car my_matrix) (- (length (car my_matrix)) diagonal 1))))\n        )\n      )\n      (sum_diagonal_reverse_helper my_matrix diagonal 0)\n    )\n    (define (check_row my_matrix row)\n      (if (null? my_matrix)\n          #t\n          (if (= (sum_row my_matrix row)",
    "  (let* ([m (length my_matrix)]\n         [n (length (car my_matrix))]\n         [sum (apply + (map (lambda (x) (apply + x)) my_matrix))]\n         [sum_diag1 (apply + (map (lambda (x y) (list-ref (list-ref my_matrix x) y)) (build-list m (lambda (x) x)) (build-list m (lambda (x) x))))]\n         [sum_diag2 (apply + (map (lambda (x y) (list-ref (list-ref my_matrix x) y)) (build-list m (lambda (x) x)) (build-list m (lambda (x) (- (sub1 m) x)))))]\n         [sum_row (apply + (map (lambda (x) (apply + x)) my_matrix))]\n         [sum_col (apply + (map (lambda (x) (apply + (map (lambda (y) (list-ref y x)) my_matrix))) (build-list n (lambda (x) x))))])\n    (and (= sum sum_diag1) (= sum sum_diag2) (= sum sum_row) (= sum sum_col))))\n",
    "  (let* ([n (length my_matrix)]\n         [sum (apply + (list-ref my_matrix 0))])\n    (and\n     (= n (length (list-ref my_matrix 0)))\n     (andmap\n      (lambda (row) (= sum (apply + row)))\n      my_matrix)\n     (andmap\n      (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix))))\n      (range n))\n     (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n     (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))]\n         [row_sums (map (lambda (row) (apply + row)) my_matrix)]\n         [col_sums (map (lambda (col) (apply + col)) (transpose my_matrix))]\n         [diag_sums (list (apply + (diagonal my_matrix))\n                          (apply + (diagonal (reverse my_matrix))))])\n    (and (= n m)\n         (= (length row_sums) n)\n         (= (length col_sums) n)\n         (= (length diag_sums) 2)\n         (every? (lambda (x) (= x sum)) row_sums)\n         (every? (lambda (x) (= x sum)) col_sums)\n         (every? (lambda (x) (= x sum)) diag_sums))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix))))\n                 (range n))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let ([n (length my_matrix)])\n    (and\n     (= n (length (car my_matrix)))\n     (= (apply + (map (lambda (x) (apply + x)) my_matrix)) (* n (/ (+ 1 (* n n)) 2)))\n     (= (apply + (map (lambda (x) (apply + x)) (transpose my_matrix))) (* n (/ (+ 1 (* n n)) 2)))\n     (= (apply + (map (lambda (x) (list-ref x x)) my_matrix)) (* n (/ (+ 1 (* n n)) 2)))\n     (= (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix)) (* n (/ (+ 1 (* n n)) 2))))))\n",
    "  (let ([n (length my_matrix)])\n    (define (sum_of_row row)\n      (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n    (define (sum_of_col col)\n      (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n    (define (sum_of_diag)\n      (apply + (map (lambda (x) (vector-ref x x)) my_matrix)))\n    (define (sum_of_diag2)\n      (apply + (map (lambda (x) (vector-ref x (- n 1 x))) my_matrix)))\n    (define (sum_of_row_col row col)\n      (apply + (map (lambda (x) (vector-ref x col)) (map (lambda (x) (vector-ref x row)) my_matrix))))\n    (define (sum_of_row_col2 row col)\n      (apply + (map (lambda (x) (vector-ref x (- n 1 col))) (map (lambda (x) (vector-ref x row)) my_matrix))))\n    (define (sum_of_row_col3 row col)\n      (apply + (map (lambda (x) (vector-ref x col)) (map (lambda (x) (vector-ref x (- n 1 row))) my_matrix))))\n    (define (sum_of_row_col4 row col)\n      (apply + (map (lambda (x) (vector-ref x (- n 1 col))) (map (lambda (x) (vector-ref x (- n 1 row))) my_matrix))))\n    (define (sum_of_row_col5 row col)\n      (apply + (map (lambda (x) (vector-ref x (- n 1 col))) (map (lambda (x) (vector-ref x row)) my_matrix))))\n    (define (sum_of_row_col6 row col)\n      (apply + (map (lambda (x) (vector-ref x col)) (map (lambda (x) (vector-ref x (- n 1 row))) my_matrix))))\n    (define (sum_of_",
    "  (let ([n (length my_matrix)])\n    (let ([sum (apply + (map (lambda (x) (apply + x)) my_matrix))])\n      (and (apply and (map (lambda (x) (= sum (apply + x))) my_matrix))\n           (apply and (map (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n)))\n           (= sum (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) x)) (range n))))\n           (= sum (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) (- n 1 x))) (range n))))))))\n",
    "  (let ((n (length my_matrix)))\n    (define (magic_square_test_helper my_matrix)\n      (let ((n (length my_matrix)))\n        (if (= n 1)\n            #t\n            (and\n             (= (apply + (map (lambda (x) (car x)) my_matrix))\n                (apply + (map (lambda (x) (car (reverse x))) my_matrix)))\n             (= (apply + (map (lambda (x) (car x)) my_matrix))\n                (apply + (map (lambda (x) (car (reverse x))) my_matrix)))\n             (= (apply + (map (lambda (x) (car x)) my_matrix))\n                (apply + (map (lambda (x) (car (reverse x))) my_matrix)))\n             (= (apply + (map (lambda (x) (car x)) my_matrix))\n                (apply + (map (lambda (x) (car (reverse x))) my_matrix)))\n             (= (apply + (map (lambda (x) (car x)) my_matrix))\n                (apply + (map (lambda (x) (car (reverse x))) my_matrix)))\n             (= (apply + (map (lambda (x) (car x)) my_matrix))\n                (apply + (map (lambda (x) (car (reverse x))) my_matrix)))\n             (= (apply + (map (lambda (x) (car x)) my_matrix))\n                (apply + (map (lambda (x) (car (reverse x))) my_matrix)))\n             (= (apply + (map (lambda (x) (car x)) my_matrix))\n                (apply + (map (lambda (x) (car (reverse x))) my_matrix)))\n             (= (apply + (map (lambda (x) (car x)) my_matrix))\n                (apply + (map (lambda (x) (car (reverse x))) my_matrix)))\n             (= (apply + (map (lambda (x) (car x)) my_matrix))\n                (apply + (map (lambda (x) (car (reverse x))) my_matrix)))\n            ",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (every (lambda (row) (= sum (apply + row))) my_matrix)\n         (every (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (define (magic_square_test_helper_helper my_matrix)\n      (define (magic_square_test_helper_helper_helper my_matrix)\n        (define (magic_square_test_helper_helper_helper_helper my_matrix)\n          (define (magic_square_test_helper_helper_helper_helper_helper my_matrix)\n            (define (magic_square_test_helper_helper_helper_helper_helper_helper my_matrix)\n              (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                  (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                    (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                      (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                        (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                          (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                            (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_hel",
    "  (let ((n (length my_matrix)))\n    (let ((magic_number (* n (+ n 1) (/ (+ n 1) 2))))\n      (and\n       (for/and ([row my_matrix])\n         (= magic_number (apply + row)))\n       (for/and ([col (in-range n)])\n         (= magic_number (apply + (map (lambda (row) (list-ref row col)) my_matrix))))\n       (= magic_number (apply + (map (lambda (row) (list-ref row (- n 1))) my_matrix)))\n       (= magic_number (apply + (map (lambda (row) (list-ref row 0)) my_matrix)))))))\n",
    "  (define (magic_square_test_helper my_matrix row_sum)\n    (if (null? my_matrix)\n        (if (null? (cdr my_matrix))\n            #t\n            (if (= row_sum (apply + (car my_matrix)))\n                (magic_square_test_helper (cdr my_matrix) row_sum)\n                #f))\n        #f))\n  (magic_square_test_helper my_matrix (apply + (car my_matrix))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= (length (car my_matrix)) n)\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n                 (range 1 n))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n                 (range 1 n))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n                 (range 1 n))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n                 (range 1 n)))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum_row (map (lambda (row) (apply + row)) my_matrix)]\n         [sum_col (map (lambda (col) (apply + col)) (transpose my_matrix))]\n         [sum_diag (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n)))])\n    (and (= n m)\n         (apply = sum_row)\n         (apply = sum_col)\n         (= (apply + sum_row) sum_diag))))\n",
    "  (let ([n (length my_matrix)])\n    (and\n     (= n (length (car my_matrix)))\n     (let ([sum (apply + (car my_matrix))])\n       (andmap\n        (lambda (row) (= sum (apply + row)))\n        my_matrix))\n     (let ([sum (apply + (map (lambda (i) (list-ref (car my_matrix) i)) (range n)))]\n           [sum2 (apply + (map (lambda (i) (list-ref (car my_matrix) i)) (reverse (range n))))])\n       (andmap\n        (lambda (i) (= sum (apply + (map (lambda (row) (list-ref row i)) my_matrix))))\n        (range n))\n       (= sum sum2)))))\n",
    "  (let ([n (length my_matrix)])\n    (let ([magic_sum (apply + (map (lambda (x) (list-ref x 0)) my_matrix))])\n      (and\n       (andmap (lambda (x) (= magic_sum (apply + x))) my_matrix)\n       (andmap (lambda (x) (= magic_sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))\n       (= magic_sum (+ (apply + (map (lambda (x) (list-ref x x)) my_matrix)) (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix))))))))\n",
    "  (let* ([n (length my_matrix)]\n         [s (sum (map (lambda (x) (sum x)) my_matrix))]\n         [s1 (sum (map (lambda (x) (list-ref x 0)) my_matrix))]\n         [s2 (sum (map (lambda (x) (list-ref x 1)) my_matrix))]\n         [s3 (sum (map (lambda (x) (list-ref x 2)) my_matrix))]\n         [s4 (sum (map (lambda (x) (list-ref x 3)) my_matrix))]\n         [s5 (sum (map (lambda (x) (list-ref x 4)) my_matrix))]\n         [s6 (sum (map (lambda (x) (list-ref x 5)) my_matrix))]\n         [s7 (sum (map (lambda (x) (list-ref x 6)) my_matrix))]\n         [s8 (sum (map (lambda (x) (list-ref x 7)) my_matrix))]\n         [s9 (sum (map (lambda (x) (list-ref x 8)) my_matrix))]\n         [s10 (sum (map (lambda (x) (list-ref x 0)) (map (lambda (x) (list-ref x 0)) my_matrix)))])\n    (and (= s s1) (= s s2) (= s s3) (= s s4) (= s s5) (= s s6) (= s s7) (= s s8) (= s s9) (= s s10))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix (- n 1 i)) i)) (range n)))))))\n",
    "  (let ((n (length my_matrix)))\n    (and\n     (= (apply + (map (lambda (x) (list-ref x 0)) my_matrix))\n        (* n (/ (+ 1 n) 2)))\n     (= (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix))\n        (* n (/ (+ 1 n) 2)))\n     (= (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix))\n        (* n (/ (+ 1 n) 2)))\n     (= (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix))\n        (* n (/ (+ 1 n) 2)))\n     (= (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix))\n        (* n (/ (+ 1 n) 2)))\n     (= (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix))\n        (* n (/ (+ 1 n) 2)))\n     (= (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix))\n        (* n (/ (+ 1 n) 2)))\n     (= (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix))\n        (* n (/ (+ 1 n) 2))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (transpose my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (x) (apply + x)) (diagonals (reverse my_matrix))))\n            (* n (+ n 1) (/ n 2))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n                 (iota n))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n                 (iota n))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n                 (iota n))\n         (andmap (lambda (i) (= (sum (map (lambda (row) (list-ref row i)) my_matrix))\n                                (sum (map (lambda (row) (list-ref row 0)) my_matrix))))\n                 (iota n)))))\n</code>\nI'm not sure if this is the best way to do it. I'm not sure if I'm using <code>andmap</code> correctly. I'm not sure if I'm using <code>list-ref</code> correctly. I'm not sure if I'm using <code>map</code> correctly. I'm not sure if I'm using <code>lambda</code> correctly. I'm not sure if I'm using <code>let</code> correctly. I'm not sure if I'm using <code>sum</code> correctly. I'm not sure if I'm using <code>iota</code> correctly. I'm not sure if I'm using <code>and</code> correctly. I'm not sure if I'm using <code>define</code> correctly.\nI'm not sure if I'm using Racket correctly.\nI'm not sure if I'm using parentheses correctly.\nI'm not sure if I'm using indentation correctly.\nI'm not sure if I'm using <code>;</code>",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix))))\n                 (range m))\n         (= sum (apply + (map (lambda (row) (list-ref row (- n 1))) my_matrix)))\n         (= sum (apply + (map (lambda (row) (list-ref row (- m 1))) my_matrix))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (every (\u03bb (row) (= sum (apply + row))) my_matrix)\n         (every (\u03bb (col) (= sum (apply + col))) (transpose my_matrix))\n         (= sum (apply + (diagonal my_matrix)))\n         (= sum (apply + (diagonal (reverse my_matrix)))))))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (define (magic_square_test_helper_helper my_matrix)\n      (define (magic_square_test_helper_helper_helper my_matrix)\n        (define (magic_square_test_helper_helper_helper_helper my_matrix)\n          (define (magic_square_test_helper_helper_helper_helper_helper my_matrix)\n            (define (magic_square_test_helper_helper_helper_helper_helper_helper my_matrix)\n              (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                  (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                    (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                      (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                        (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                          (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                            (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_hel",
    "  (let ((n (length my_matrix)))\n    (define (sum_row row)\n      (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n    (define (sum_col col)\n      (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n    (define (sum_diag)\n      (apply + (map (lambda (x) (vector-ref x x)) my_matrix)))\n    (define (sum_diag2)\n      (apply + (map (lambda (x) (vector-ref x (- n x 1))) my_matrix)))\n    (define (sum_row_col row col)\n      (apply + (map (lambda (x) (vector-ref x row)) (map (lambda (x) (vector-ref x col)) my_matrix))))\n    (define (sum_row_col2 row col)\n      (apply + (map (lambda (x) (vector-ref x row)) (map (lambda (x) (vector-ref x (- n col 1))) my_matrix))))\n    (define (sum_row_col3 row col)\n      (apply + (map (lambda (x) (vector-ref x (- n row 1))) (map (lambda (x) (vector-ref x col)) my_matrix))))\n    (define (sum_row_col4 row col)\n      (apply + (map (lambda (x) (vector-ref x (- n row 1))) (map (lambda (x) (vector-ref x (- n col 1))) my_matrix))))\n    (define (sum_row_col5 row col)\n      (apply + (map (lambda (x) (vector-ref x row)) (map (lambda (x) (vector-ref x (- n col 1))) my_matrix))))\n    (define (sum_row_col6 row col)\n      (apply + (map (lambda (x) (vector-ref x (- n row 1))) (map (lambda (x) (vector-ref x col)) my_matrix))))\n    (define (sum_row_col7 row col)\n      (apply + (map (lambda (x) (vector-ref",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (every (lambda (row) (= sum (apply + row))) my_matrix)\n         (every (lambda (col) (= sum (apply + col)))\n                (for/list ([i (in-range n)])\n                  (for/list ([j (in-range m)])\n                    (list-ref (list-ref my_matrix j) i)))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= (length (car my_matrix)) n)\n         (= (apply + (car my_matrix)) (/ (* n (+ n 1)) 2))\n         (= (apply + (map (lambda (x) (car x)) my_matrix)) (/ (* n (+ n 1)) 2))\n         (= (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix)) (/ (* n (+ n 1)) 2))\n         (= (apply + (map (lambda (x) (list-ref x (- n 1))) (reverse my_matrix))) (/ (* n (+ n 1)) 2))\n         (= (apply + (map (lambda (x) (list-ref x (/ n 2))) my_matrix)) (/ (* n (+ n 1)) 2))\n         (= (apply + (map (lambda (x) (list-ref x (/ n 2))) (reverse my_matrix))) (/ (* n (+ n 1)) 2)))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (let ([sum (apply + (car my_matrix))])\n           (andmap (lambda (row) (= sum (apply + row))) my_matrix))\n         (let ([sum (apply + (map (lambda (i) (list-ref (car my_matrix) i))\n                                  (range n)))]\n                 [sum-diag1 (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i))\n                                         (range n)))]\n                 [sum-diag2 (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i)))\n                                         (range n)))])\n           (and (= sum sum-diag1)\n                (= sum sum-diag2)\n                (andmap (lambda (i) (= sum (apply + (map (lambda (j) (list-ref (list-ref my_matrix j) i))\n                                                          (range n)))))\n                        (range n)))))))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (define (magic_square_test_helper_helper my_matrix)\n      (define (magic_square_test_helper_helper_helper my_matrix)\n        (define (magic_square_test_helper_helper_helper_helper my_matrix)\n          (define (magic_square_test_helper_helper_helper_helper_helper my_matrix)\n            (define (magic_square_test_helper_helper_helper_helper_helper_helper my_matrix)\n              (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                  (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                    (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                      (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                        (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                          (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                            (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_hel",
    "  (let ((n (length my_matrix)))\n    (and (= n (length (car my_matrix)))\n         (andmap (lambda (x) (= (sum x) (sum (transpose my_matrix x))))\n                 (build-list n (lambda (i) i)))\n         (andmap (lambda (x) (= (sum x) (sum (transpose my_matrix x))))\n                 (build-list n (lambda (i) (- n 1 i)))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (row) (apply + row)) my_matrix))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (col) (apply + col))\n                          (transpose my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (diag) (apply + diag))\n                          (diagonals my_matrix)))\n            (* n (+ n 1) (/ n 2)))\n         (= (apply + (map (lambda (diag) (apply + diag))\n                          (diagonals (reverse my_matrix))))\n            (* n (+ n 1) (/ n 2))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))]\n         [sum-list (list sum)])\n    (if (and (= n m)\n             (= (apply + (map (lambda (x) (apply + x)) my_matrix)) (* sum n)))\n        (for ([i (in-range n)])\n          (if (and (= (apply + (map (lambda (x) (list-ref x i)) my_matrix)) sum)\n                   (= (apply + (map (lambda (x) (list-ref x (- n 1 i))) my_matrix)) sum)\n                   (= (apply + (map (lambda (x) (list-ref x i)) (transpose my_matrix))) sum))\n              (set! sum-list (append sum-list (list (apply + (map (lambda (x) (list-ref x i)) my_matrix)))))\n              (set! sum-list (append sum-list (list (apply + (map (lambda (x) (list-ref x (- n 1 i))) my_matrix)))))\n              (set! sum-list (append sum-list (list (apply + (map (lambda (x) (list-ref x i)) (transpose my_matrix))))))\n              (set! sum-list (append sum-list (list (apply + (map (lambda (x) (list-ref x (- n 1 i))) (transpose my_matrix)))))))\n          (if (and (= (apply + (map (lambda (x) (list-ref x i)) my_matrix)) sum)\n                   (= (apply + (map (lambda (x) (list-ref x (- n 1 i))) my_matrix)) sum)\n                   (= (apply + (map (lambda (x) (list-ref x i)) (transpose my_matrix))) sum)\n                   (= (apply + (map (lambda (x) (list-ref x (- n 1 i))) (transpose my_matrix))) sum))\n              (set! sum-list (append sum-list (list (apply + (map (lambda (x) (list-ref",
    "  (let ((n (length my_matrix)))\n    (let ((sum (apply + (map (lambda (x) (apply + x)) my_matrix))))\n      (and\n       (andmap (lambda (x) (= sum (apply + x))) my_matrix)\n       (andmap (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))))))\n",
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (sums (list 0 0 0 0 0 0 0 0 0)))\n    (for ((i 0 (+ i 1))\n          (j 0 (+ j 1)))\n        ((and (&lt; i n) (&lt; j m))\n         (for ((i 0 (+ i 1))\n               (j 0 (+ j 1)))\n             ((&lt; i n)\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix i) j)))\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix j) i)))\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix i) (- m j))))\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix (- m i)) j)))\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix (- m i)) (- m j))))\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix (- m j)) (- m i))))\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix (- m j)) i)))\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix i) (- m j))))\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix j) (- m i))))\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix (- m i)) (- m j))))\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix (- m j)) i)))\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix (- m j)) (- m i))))\n              (set-car! sums (+ (car sums) (list-ref (list-ref my_matrix j)",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [magic_sum (apply + (range 1 (+ n 1)))]\n         [row_sums (map (lambda (row) (apply + row)) my_matrix)]\n         [col_sums (map (lambda (col_index) (apply + (map (lambda (row) (list-ref row col_index)) my_matrix))) (range 0 m))]\n         [diag_sums (list (apply + (map (lambda (index) (list-ref (list-ref my_matrix index) index)) (range 0 n)))\n                          (apply + (map (lambda (index) (list-ref (list-ref my_matrix index) (- n 1 index))) (range 0 n))))])\n    (and (= n m)\n         (= magic_sum (apply + row_sums))\n         (= magic_sum (apply + col_sums))\n         (= magic_sum (apply + diag_sums)))))\n",
    "  (let ((n (length my_matrix)))\n    (let ((sum (apply + (map (lambda (x) (apply + x)) my_matrix))))\n      (and\n       (= n (length (car my_matrix)))\n       (every (lambda (x) (= sum (apply + x))) my_matrix)\n       (every (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range m))\n         (= sum (apply + (map (lambda (row) (list-ref row (- n 1))) my_matrix)))\n         (= sum (apply + (map (lambda (row) (list-ref row 0)) my_matrix))))))\n",
    "  (let ((n (length my_matrix)))\n    (and\n     (andmap (lambda (x) (= (sum x) (sum (first my_matrix)))) my_matrix)\n     (andmap (lambda (x) (= (sum x) (sum (map first my_matrix)))) (transpose my_matrix))\n     (andmap (lambda (x) (= (sum x) (sum (map first (reverse my_matrix))))) (reverse my_matrix))\n     (andmap (lambda (x) (= (sum x) (sum (map first (reverse (transpose my_matrix)))))) (transpose (reverse my_matrix)))\n     (andmap (lambda (x) (= (sum x) (sum (map first (reverse (transpose (reverse my_matrix))))))) (transpose (reverse (reverse my_matrix))))\n     (andmap (lambda (x) (= (sum x) (sum (map first (reverse (reverse my_matrix)))))) (reverse (reverse my_matrix))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix))))\n                 (range m))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (let* ((n (length my_matrix))\n         (m (length (car my_matrix)))\n         (sum (apply + (car my_matrix)))\n         (sum_list (list sum)))\n    (for ((i 1) (j 0))\n        ((= i n))\n      (set! sum_list (cons (apply + (list-ref my_matrix i)) sum_list))\n      (set! i (+ i 1)))\n    (for ((i 0) (j 0))\n        ((= i n))\n      (set! sum_list (cons (apply + (map (lambda (x) (list-ref x j)) my_matrix)) sum_list))\n      (set! i (+ i 1)))\n    (set! sum_list (cons (apply + (map (lambda (x) (list-ref x i)) my_matrix)) sum_list))\n    (set! sum_list (cons (apply + (map (lambda (x) (list-ref x (- n 1))) my_matrix)) sum_list))\n    (cond ((= (length (remove-duplicates sum_list)) 1) #t)\n          (else #f))))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (define (sum_row my_matrix row)\n      (apply + (map (lambda (x) (list-ref x row)) my_matrix)))\n    (define (sum_col my_matrix col)\n      (apply + (map (lambda (x) (list-ref x col)) my_matrix)))\n    (define (sum_diag my_matrix)\n      (apply + (map (lambda (x) (list-ref x x)) my_matrix)))\n    (define (sum_diag_rev my_matrix)\n      (apply + (map (lambda (x) (list-ref x (- (length my_matrix) x 1))) my_matrix)))\n    (define (check_sum my_matrix sum)\n      (andmap (lambda (x) (= x sum)) (map (lambda (x) (sum_row my_matrix x)) (range (length my_matrix)))\n              (map (lambda (x) (sum_col my_matrix x)) (range (length my_matrix)))\n              (list (sum_diag my_matrix) (sum_diag_rev my_matrix))))\n    (check_sum my_matrix (sum_row my_matrix 0)))\n  (and (= (length my_matrix) (length (car my_matrix)))\n       (magic_square_test_helper my_matrix)))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (andmap (lambda (x) (= x (apply + (car my_matrix))))\n                 (map (lambda (x) (apply + x)) my_matrix))\n         (andmap (lambda (x) (= x (apply + (map (lambda (y) (list-ref y x)) my_matrix))))\n                 (map (lambda (x) (apply + x)) my_matrix))\n         (andmap (lambda (x) (= x (apply + (map (lambda (y) (list-ref y x)) my_matrix))))\n                 (map (lambda (x) (apply + x)) my_matrix))\n         (andmap (lambda (x) (= x (apply + (map (lambda (y) (list-ref y x)) my_matrix))))\n                 (map (lambda (x) (apply + x)) my_matrix)))))\n",
    "  (let ([n (length my_matrix)])\n    (let loop ([i 0] [sum 0])\n      (if (= i n)\n          (= sum (apply + (map (lambda (x) (list-ref x 0)) my_matrix)))\n          (loop (+ i 1) (+ sum (list-ref (list-ref my_matrix i) i)))))))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (let ([sum (apply + (car my_matrix))])\n           (andmap (lambda (row) (= sum (apply + row))) my_matrix))\n         (let ([sum (apply + (map (lambda (row) (list-ref row 0)) my_matrix))])\n           (andmap (lambda (row) (= sum (apply + row))) (transpose my_matrix)))\n         (let ([sum (apply + (map (lambda (row) (list-ref row (- n 1))) my_matrix))])\n           (andmap (lambda (row) (= sum (apply + row))) (transpose my_matrix)))\n         (= (apply + (map (lambda (row) (list-ref row (- n 1))) my_matrix))\n            (apply + (map (lambda (row) (list-ref row 0)) my_matrix)))\n         (= (apply + (map (lambda (row) (list-ref row 0)) my_matrix))\n            (apply + (map (lambda (row) (list-ref row (- n 1))) my_matrix))))))\n",
    "  (let ([n (length my_matrix)])\n    (define (magic_square_test_helper my_matrix i j)\n      (if (= i n)\n          (if (= j n)\n              #t\n              (magic_square_test_helper my_matrix 0 (+ j 1)))\n          (if (= j n)\n              (magic_square_test_helper my_matrix (+ i 1) 0)\n              (if (= (vector-ref (vector-ref my_matrix i) j)\n                     (vector-ref (vector-ref my_matrix (+ i 1)) (+ j 1)))\n                  (magic_square_test_helper my_matrix (+ i 1) (+ j 1))\n                  #f))))\n    (magic_square_test_helper my_matrix 0 0)))\n",
    "  (let ([n (length my_matrix)])\n    (and (= n (length (car my_matrix)))\n         (= (apply + (map (lambda (x) (apply + x)) my_matrix)) (* n (/ (* n (+ n 1)) 2)))\n         (= (apply + (map (lambda (x) (apply + (map (lambda (y) (list-ref y x)) my_matrix))) my_matrix)) (* n (/ (* n (+ n 1)) 2)))\n         (= (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) x)) (range n))) (* n (/ (* n (+ n 1)) 2)))\n         (= (apply + (map (lambda (x) (list-ref (list-ref my_matrix x) (- n 1 x))) (range n))) (* n (/ (* n (+ n 1)) 2))))))\n",
    "  (define (sum_of_row row)\n    (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n  (define (sum_of_col col)\n    (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n  (define (sum_of_diag)\n    (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range (vector-length (vector-ref my_matrix 0)) 0 -1))))\n  (define (sum_of_anti_diag)\n    (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range 0 (vector-length (vector-ref my_matrix 0))))))\n  (define (sum_of_all)\n    (apply + (map (lambda (x) (apply + x)) my_matrix)))\n  (define (sum_of_row_col)\n    (apply + (map (lambda (x) (vector-ref x 0)) my_matrix)))\n  (define (sum_of_row_col_diag)\n    (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range 0 (vector-length (vector-ref my_matrix 0))))))\n  (define (sum_of_row_col_anti_diag)\n    (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range (vector-length (vector-ref my_matrix 0)) 0 -1))))\n  (define (sum_of_row_col_diag_anti_diag)\n    (apply + (map (lambda (x y) (vector-ref x y)) my_matrix (range 0 (vector-length (vector-ref my_matrix 0))))))\n  (define (sum_of_row_col_diag_anti_diag_all)\n    (apply + (map (lambda (x) (apply + x)) my_matrix)))\n  (define (sum_of_row_col_diag_anti_diag_all_row_col)\n    (",
    "  (define (sum_row row)\n    (apply + (map (lambda (x) (vector-ref x row)) my_matrix)))\n  (define (sum_col col)\n    (apply + (map (lambda (x) (vector-ref x col)) my_matrix)))\n  (define (sum_diag)\n    (apply + (map (lambda (x) (vector-ref x x)) my_matrix)))\n  (define (sum_diag_rev)\n    (apply + (map (lambda (x) (vector-ref x (- (vector-length my_matrix) x 1))) my_matrix)))\n  (define (sum_all)\n    (apply + (map sum_row my_matrix)))\n  (define (check_row row)\n    (if (= (sum_row row) (sum_all))\n        #t\n        #f))\n  (define (check_col col)\n    (if (= (sum_col col) (sum_all))\n        #t\n        #f))\n  (define (check_diag)\n    (if (= (sum_diag) (sum_all))\n        #t\n        #f))\n  (define (check_diag_rev)\n    (if (= (sum_diag_rev) (sum_all))\n        #t\n        #f))\n  (define (check_all)\n    (if (and (check_row 0) (check_row 1) (check_row 2) (check_col 0) (check_col 1) (check_col 2) (check_diag) (check_diag_rev))\n        #t\n        #f))\n  (check_all))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range n))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) (- n 1 i))) (range n)))))))\n",
    "  (define (magic_square_test_helper my_matrix)\n    (define (magic_square_test_helper_helper my_matrix)\n      (define (magic_square_test_helper_helper_helper my_matrix)\n        (define (magic_square_test_helper_helper_helper_helper my_matrix)\n          (define (magic_square_test_helper_helper_helper_helper_helper my_matrix)\n            (define (magic_square_test_helper_helper_helper_helper_helper_helper my_matrix)\n              (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                  (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                    (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                      (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                        (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                          (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper my_matrix)\n                            (define (magic_square_test_helper_helper_helper_helper_helper_helper_helper_helper_helper_helper_hel",
    "  (let ([n (length my_matrix)])\n    (let ([sum (apply + (map (lambda (x) (apply + x)) my_matrix))])\n      (and\n       (andmap (lambda (x) (= sum (apply + x))) my_matrix)\n       (andmap (lambda (x) (= sum (apply + (map (lambda (y) (list-ref y x)) my_matrix)))) (range n))))))\n",
    "  (let* ([n (length my_matrix)]\n         [m (length (car my_matrix))]\n         [sum (apply + (car my_matrix))])\n    (and (= n m)\n         (andmap (lambda (row) (= sum (apply + row))) my_matrix)\n         (andmap (lambda (col) (= sum (apply + (map (lambda (row) (list-ref row col)) my_matrix)))) (range 0 n))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix i) i)) (range 0 n))))\n         (= sum (apply + (map (lambda (i) (list-ref (list-ref my_matrix (- n 1 i)) i)) (range 0 n)))))))\n"
  ]
}